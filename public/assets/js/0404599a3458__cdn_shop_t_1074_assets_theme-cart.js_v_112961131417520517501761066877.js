"use strict";(self.webpackChunkshopify_theme=self.webpackChunkshopify_theme||[]).push([[339],{"23c96b82ee364a9c5a22":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var helpers=__webpack_require__("39f54b870a48e387df3c"),react=__webpack_require__("9811ef06b956fcd727d6"),format_money=__webpack_require__("71c1c01bc06c47144711"),get_ajax_section=__webpack_require__("43debc60607aaaeb7620"),cart_helpers=__webpack_require__("3dcac4a0487debd3dd31"),components_button=__webpack_require__("23e95556235fef5f648f"),dist=__webpack_require__("96294add2d9632ee5da8"),io=__webpack_require__("b8a6475f1374bf47365a");const GiftWrapCardSettingsIO=(0,dist.type)({image:(0,dist.string)(),title:(0,dist.string)(),threshold:(0,dist.string)(),atc_color:(0,dist.string)()}),GiftWrapBannerSettingsIO=(0,dist.type)({drawer_banner_title:(0,dist.string)(),drawer_banner_text:(0,dist.string)(),drawer_banner_image:(0,dist.nullable)((0,dist.string)()),drawer_banner_video:(0,dist.nullable)((0,dist.string)()),drawer_banner_media_type:(0,dist.union)([(0,dist.literal)("image"),(0,dist.literal)("video")])}),GiftWrapDrawerSettingsIO=(0,dist.type)({drawer_title:(0,dist.string)(),drawer_text:(0,dist.string)(),banner:GiftWrapBannerSettingsIO}),GiftWrapVariantIO=(0,dist.type)({price:(0,dist.number)(),title:(0,dist.string)(),id:(0,dist.number)(),available:(0,dist.boolean)(),description:(0,dist.nullable)((0,dist.string)()),image:(0,dist.string)(),swatch_image:(0,dist.nullable)((0,dist.string)()),swatch_color:(0,dist.optional)((0,dist.string)()),options:(0,dist.array)((0,dist.string)())}),GiftWrapProductIO=(0,dist.type)({product_id:(0,dist.nullable)((0,dist.number)()),quantity_limit:(0,dist.number)(),product_title:(0,dist.optional)((0,dist.string)()),product_image:(0,dist.string)(),options_with_values:(0,dist.nullable)(io.OptionsWithValues),variants:(0,dist.array)(GiftWrapVariantIO)}),GiftWrapSettingsIO=(0,dist.type)({enabled:(0,dist.boolean)(),enable_recommendations:(0,dist.boolean)(),enable_free_product:(0,dist.boolean)(),size_threshold:(0,dist.nullable)((0,dist.number)()),price_threshold:(0,dist.nullable)((0,dist.number)()),gift_wrap_card:GiftWrapCardSettingsIO,gift_wrap_drawer:GiftWrapDrawerSettingsIO,gift_wrap_product:(0,dist.nullable)(GiftWrapProductIO)}),FreeGiftSettingsIO=(0,dist.type)({is_free_gift_enabled:(0,dist.nullable)((0,dist.boolean)()),free_gift_requisite_quantity:(0,dist.nullable)((0,dist.number)()),free_gift_requisite_products:(0,dist.nullable)((0,dist.array)((0,dist.number)())),free_gift_requisite_product_no_qty:(0,dist.nullable)((0,dist.array)((0,dist.number)())),variant_id:(0,dist.nullable)((0,dist.number)()),free_gift_removed_from_cart_message:(0,dist.nullable)((0,dist.string)()),promotion:(0,dist.optional)((0,dist.object)({enabled:(0,dist.nullable)((0,dist.boolean)()),title:(0,dist.nullable)((0,dist.string)()),description:(0,dist.nullable)((0,dist.string)()),image:(0,dist.nullable)((0,dist.string)()),section_title:(0,dist.nullable)((0,dist.string)()),cta_label:(0,dist.nullable)((0,dist.string)())}))}),UpsellProductIO=(0,dist.type)({product:(0,dist.nullable)(io.Product),upsell_title:(0,dist.nullable)((0,dist.string)()),show_smp_layout:(0,dist.boolean)(),redirect_to_product:(0,dist.boolean)(),url:(0,dist.nullable)((0,dist.string)()),cta_label:(0,dist.nullable)((0,dist.string)())}),UpsellProductsExtraDataIO=(0,dist.array)((0,dist.object)({product_id:(0,dist.number)(),variants:(0,dist.array)((0,dist.object)({id:(0,dist.number)(),oos_mode:(0,dist.string)(),oos_message:(0,dist.nullable)((0,dist.string)()),swatch_image:(0,dist.nullable)((0,dist.string)()),swatch_color:(0,dist.nullable)((0,dist.string)())}))})),CartDrawerIO=(0,dist.type)({moneyFormat:(0,dist.string)(),cartTitle:(0,dist.string)(),freeShippingThreshold:(0,dist.string)(),freeShippingSwitch:(0,dist.boolean)(),freeShippingMessage:(0,dist.nullable)((0,dist.string)()),freeShippingMessageBefore:(0,dist.nullable)((0,dist.string)()),freeShippingUnlockedMessage:(0,dist.nullable)((0,dist.string)()),rebuy_endpoint:(0,dist.nullable)((0,dist.string)()),upsellProducts:(0,dist.array)(UpsellProductIO),upsellCollectionProducts:(0,dist.array)(io.Product),upsellCollectionImages:(0,dist.array)((0,dist.object)({id:(0,dist.string)(),image:(0,dist.string)()})),upsellCollectionNotes:(0,dist.array)((0,dist.object)({id:(0,dist.string)(),note:(0,dist.string)()})),upsellProductsExtraData:UpsellProductsExtraDataIO,buttonMode:(0,dist.nullable)((0,dist.string)()),freeGiftSettings:(0,dist.optional)(FreeGiftSettingsIO),giftWrapSettings:(0,dist.optional)(GiftWrapSettingsIO)}),CartQuantityData=(0,dist.type)({available:(0,dist.boolean)()}),CartItemIO=(0,dist.type)({variant_id:(0,dist.number)(),quantity:(0,dist.number)(),max_variants_limit:(0,dist.number)(),quantity_limit:(0,dist.number)(),variant_quantity_limit:(0,dist.number)(),variant_size_score:(0,dist.string)(),custom_bundle_uid:(0,dist.nullable)((0,dist.string)()),custom_bundle_title:(0,dist.nullable)((0,dist.string)()),custom_bundle_image:(0,dist.nullable)((0,dist.string)()),smp_variant_title:(0,dist.optional)((0,dist.nullable)((0,dist.string)()))}),CartData=((0,dist.type)({item:CartItemIO,quantity:(0,dist.number)(),custom_bundle_uid:(0,dist.string)()}),(0,dist.type)({items:(0,dist.array)(CartItemIO)})),InternalQuantityErrorPayload=(0,dist.type)({item_payload:(0,dist.array)((0,dist.object)({id:(0,dist.number)(),quantity:(0,dist.number)()}))});var guards=__webpack_require__("9336415c7787ae96cc39"),get_sized_image_url=__webpack_require__("dee3a8a4569acc7535be"),clsx_m=__webpack_require__("0bec4b8beb117f5ab05d");const CartDrawerItem=function({item,items,moneyFormat,changeQuantity,cartLimitNo,cartMaxVariantsLimit,isGiftBag,giftBagDescription,isFreeGiftBagEnabled=!1}){var _item_product_title,_item_options_with_values,_item_options_with_values_;const[quantityErrorVisible,setQuantityErrorVisible]=(0,react.useState)(!1),[errorType,setErrorType]=(0,react.useState)("max-qty"),isFreeGiftItem=(0,react.useMemo)(()=>{var _item_properties,_item_properties1;return((_item_properties=item.properties)===null||_item_properties===void 0?void 0:_item_properties._is_free_gwp)||((_item_properties1=item.properties)===null||_item_properties1===void 0?void 0:_item_properties1._free_gift)},[item]);(0,react.useEffect)(()=>{setTimeout(()=>{setQuantityErrorVisible(!1)},4e3)},[quantityErrorVisible]);const smpVariantTitle=(0,react.useMemo)(()=>item.smp_variant_title,[item.smp_variant_title]),itemTitle=(0,react.useMemo)(()=>{var _item_product_title2;let productTitle=(_item_product_title2=item.product_title)===null||_item_product_title2===void 0?void 0:_item_product_title2.toLocaleLowerCase();return smpVariantTitle&&productTitle&&(productTitle=productTitle.replace(smpVariantTitle.toLocaleLowerCase(),"")),productTitle?.toLocaleUpperCase()},[smpVariantTitle,item.product_title]),smpTitle=(0,react.useMemo)(()=>{var _item_product_title2;const productTitle=(_item_product_title2=item.product_title)===null||_item_product_title2===void 0?void 0:_item_product_title2.toLocaleLowerCase();return smpVariantTitle&&productTitle&&productTitle.includes(smpVariantTitle.toLocaleLowerCase())?smpVariantTitle:""},[smpVariantTitle,item.product_title]);if((0,react.useEffect)(()=>{const quantityError=localStorage.getItem("internal_quantity_error");if(!quantityError)return;const currentItemInQuantityErrorPayload=InternalQuantityErrorPayload.create(JSON.parse(quantityError)).item_payload.find(quantityErrorItem=>quantityErrorItem.id===item.variant_id);currentItemInQuantityErrorPayload&&currentItemInQuantityErrorPayload.quantity+item.quantity>cartLimitNo&&(setQuantityErrorVisible(!0),setTimeout(()=>{localStorage.setItem("internal_quantity_error","")},500))},[item,cartLimitNo]),item.handle==null)return null;const itemProperties=Object.entries(item.properties||{}).filter(function(entry){return(0,guards.isPresent)(entry[1])}).filter(function([key]){return key.slice(0,1)!=="_"}),itemImage=item.properties&&item.properties["_featured-image"]?item.properties["_featured-image"]:(0,get_sized_image_url.resizeImage)((0,get_sized_image_url.getSizedImageUrl)(item.featured_image.url)||"","300x"),reduceQtyIcon=react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},react.createElement("path",{d:"M16 10c0 .553-.048 1-.601 1H4.601C4.049 11 4 10.553 4 10c0-.553.049-1 .601-1H15.4c.552 0 .6.447.6 1z"})),increaseQtyIcon=react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},react.createElement("path",{d:"M16 10c0 .553-.048 1-.601 1H11v4.399c0 .552-.447.601-1 .601-.553 0-1-.049-1-.601V11H4.601C4.049 11 4 10.553 4 10c0-.553.049-1 .601-1H9V4.601C9 4.048 9.447 4 10 4c.553 0 1 .048 1 .601V9h4.399c.553 0 .601.447.601 1z"}));return react.createElement("div",{className:"CartItem"},react.createElement("div",{className:"CartItem-section is-image"},react.createElement("div",{className:"CartItem-imageLink"},react.createElement("div",{className:"CartItem-imagePlaceholder o-placeholder",style:{backgroundImage:itemImage?`url(${itemImage})`:void 0},"aria-label":itemImage?`image of ${(_item_product_title=item.product_title)===null||_item_product_title===void 0?void 0:_item_product_title.toLocaleUpperCase()}`:"",tabIndex:itemImage?0:-1,"aria-hidden":itemImage?"false":"true"}))),react.createElement("div",{className:(0,clsx_m.default)("CartItem-section","is-info",{"is-free-gift":isFreeGiftItem})},react.createElement("div",{className:"CartItem-title-container"},react.createElement(isFreeGiftItem||isGiftBag?"div":"a",{className:"CartItem-title",href:(url=>{const currentURL=window.location.href,locales=["en-gb","en-ca","en-fr","en-de","en-it","en-ie","en-es","en-nl","en-fi","en-at","en-gr","en-pl","en-se","en-dk"],currentLocale=locales.filter(localeURL=>currentURL.includes(localeURL)),isUrlAlreadyLocalized=locales.some(localeURL=>url.includes(localeURL));return!currentLocale.length||isUrlAlreadyLocalized?url:url.replace("/products",`/${currentLocale[0]}/products`)})(item.url)},isGiftBag?(_item_options_with_values=item.options_with_values)===null||_item_options_with_values===void 0||(_item_options_with_values_=_item_options_with_values[0])===null||_item_options_with_values_===void 0?void 0:_item_options_with_values_.value.toLocaleUpperCase():itemTitle||""),react.createElement("div",{className:"CartItem-section is-price"},react.createElement("div",{className:"CartItem-price",dangerouslySetInnerHTML:{__html:(isGiftBag||isFreeGiftItem)&&item.line_price===0?"FREE":(0,format_money.formatMoney)(item.line_price,moneyFormat)}}))),react.createElement("div",{className:"CartItem-variantTitle"},function(){const variantTitle=item.variant_title||smpTitle||"";return variantTitle.toLowerCase().indexOf("default")>=0?"":variantTitle.split("/").filter((line,index)=>{const isGiftBagColor=isGiftBag&&index!==0;return!isGiftBag&&!line.toLocaleLowerCase().includes("case only")||isGiftBagColor}).map(line=>react.createElement("span",{key:line,className:"CartItem-variantTitle-line"},line))}()),itemProperties.length?react.createElement("dl",{className:"CartItem-properties"},itemProperties.map(([,value],index)=>react.createElement("dt",{key:`${value}-${index}`,className:"CartItem-propertyTitle"},value))):null,isGiftBag||isFreeGiftItem?react.createElement("div",{className:"CartGiftWrap-item"},isGiftBag?react.createElement("span",{className:"CartGiftWrap-item__message"},giftBagDescription):null,isFreeGiftBagEnabled||isFreeGiftItem?react.createElement("button",{onClick:evt=>{evt.preventDefault(),setQuantityErrorVisible(!1),changeQuantity({items:[{lineItemKey:item.key,quantity:0}]})},className:"CartGiftWrap-item__remove",role:"button"},"Remove"):null):null,isFreeGiftItem||isGiftBag&&isFreeGiftBagEnabled?null:react.createElement("div",{className:"CartItem-section is-qty"},react.createElement("div",{className:"o-qtyControls"},react.createElement("button",{className:"js-cart-drawer-qty o-qtyControls-button",type:"button","data-action":"minus",onClick:evt=>{evt.preventDefault(),setQuantityErrorVisible(!1),changeQuantity({items:[{lineItemKey:item.key,quantity:item.quantity-1}]})}},react.createElement("div",{className:"u-vhide"},"Reduce quantity"),react.createElement("div",{className:"o-placeholder"},reduceQtyIcon)),react.createElement("div",{className:"o-qtyControls-indicator"},react.createElement("span",{className:"u-vhide"},"Quantity"),item.quantity),react.createElement("button",{className:"js-cart-drawer-qty o-qtyControls-button",type:"button","data-action":"plus",onClick:evt=>{evt.preventDefault();const variantQuantityInCart=items.reduce((acc,cartItem)=>cartItem.variant_id===item.variant_id?acc+cartItem.quantity:acc,0),totalVariantsInCart=items.reduce((acc,cartItem)=>cartItem.product_id===item.product_id?acc+cartItem.quantity:acc,0),hasMaxVariantLimit=!!cartMaxVariantsLimit&&totalVariantsInCart+1>(cartMaxVariantsLimit||0);variantQuantityInCart+1>(cartLimitNo||0)||hasMaxVariantLimit?(setErrorType(hasMaxVariantLimit?"max-variants":"max-qty"),setQuantityErrorVisible(!0)):changeQuantity({items:[{lineItemKey:item.key,quantity:item.quantity+1}]})}},react.createElement("div",{className:"u-vhide"},"Increase quantity"),react.createElement("div",{className:"o-placeholder"},increaseQtyIcon))),quantityErrorVisible&&react.createElement("p",{className:"CartItem-error-message u-noMargin u-pSize__Small"},errorType==="max-variants"?`Limit ${cartMaxVariantsLimit||0} products per customer`:`Limit ${cartLimitNo} per customer`))))};var use_machine_state=__webpack_require__("2b4a4ef9b07390ff2c29"),gift_wrap=__webpack_require__("77c8f636a2d630933468"),schema_item=__webpack_require__("daeb208f3841495d477a"),bundle_item=__webpack_require__("1c0567396fa71d5fd6ce");const app_locale={subtotal:"Subtotal",shippingAtCheckout:"*shipping, taxes, and discounts calculated at checkout.",checkout:"Checkout",itemCountZero:"Your cart is currently empty",itemCountPlural:"888 items",itemCountSingular:"1 item",qtyLabel:"Quantity",reduceQty:"Reduce quantity",increaseQty:"Increase quantity"},App=function({machine:machine2,moneyFormat="{{ amount }}",freeShippingThreshold="",freeShippingMessage="",freeShippingMessageBefore="",freeShippingSwitch,buttonMode,freeGiftSettings,giftWrapSettings}){const{name,error,warning,contents:cart2}=(0,use_machine_state.useMachineState)(machine2),[extraCartData,setExtraCartData]=(0,react.useState)(null),[freeShippingLabel,setFreeShippingLabel]=(0,react.useState)(""),[isLoading,setIsLoading]=(0,react.useState)(!1),[hasRemovedFreeItemFromCart,setHasRemovedFreeItemFromCart]=(0,react.useState)(!1),parsedShippingThreshold=parseFloat(freeShippingThreshold||""),FREE_SHIPPING_THRESHOLD=Number.isNaN(parsedShippingThreshold)?null:parsedShippingThreshold;var _cart_total_price;const cartTotalPrice=(_cart_total_price=cart2?.total_price)!==null&&_cart_total_price!==void 0?_cart_total_price:0,itemsQty=cart2?.items.reduce((acc,cartItem)=>{var _cartItem_properties;if(!((_cartItem_properties=cartItem.properties)===null||_cartItem_properties===void 0)&&_cartItem_properties._custom_bundle_uid){var _cartItem_properties1;const bundleSize=Number((_cartItem_properties1=cartItem.properties)===null||_cartItem_properties1===void 0?void 0:_cartItem_properties1._custom_bundle_size)||4;return acc+cartItem.quantity/bundleSize}return acc+cartItem.quantity},0).toFixed(0)||0,cartQuantityCount=Math.floor(cart2?.items.reduce((acc,cartItem)=>{var _cartItem_properties;return!((_cartItem_properties=cartItem.properties)===null||_cartItem_properties===void 0)&&_cartItem_properties._custom_bundle_uid?acc+cartItem.quantity/4:acc+cartItem.quantity},0)||0),drawerTitle=name==="Failure"?"Error":cart2==null?"Updating\u2026":cartQuantityCount===0?app_locale.itemCountZero:cartQuantityCount===1?app_locale.itemCountSingular:app_locale.itemCountPlural.replace("888",itemsQty.toString()||cartQuantityCount.toString(10)),parsedCartItems=(0,react.useMemo)(()=>{try{if(!cart2?.items)return[];const parsedItems=[],bundleGroups={};for(const item of cart2.items){const bundleId=(0,cart_helpers.getBundleId)(item);if(!bundleId){const itemExtraData=extraCartData?.items.find(extraCartDataItem=>extraCartDataItem.variant_id===item.variant_id);if(!itemExtraData)continue;const smpVariantTitle=itemExtraData.smp_variant_title;smpVariantTitle&&(item.smp_variant_title=smpVariantTitle),parsedItems.push(item);continue}const bundleData=(0,cart_helpers.createBundleExtraData)(item);if(bundleId in bundleGroups){var _bundleGroups_bundleId;(_bundleGroups_bundleId=bundleGroups[bundleId])===null||_bundleGroups_bundleId===void 0||_bundleGroups_bundleId.push(bundleData)}else{bundleGroups[bundleId]=[bundleData];const bundleItem=(0,cart_helpers.createBundleItem)(item,bundleId,bundleGroups[bundleId]);parsedItems.push(bundleItem)}}return parsedItems}catch(parseError){return console.error("Error parsing cart items:",parseError),cart2?.items||[]}},[cart2?.items,extraCartData?.items]);(0,react.useEffect)(()=>{name==="Ready"&&((()=>{const progressWrap=document.querySelector(".Cart-progressWrap"),wrap=document.querySelector(".Cart-progressBar");if(progressWrap instanceof HTMLElement&&wrap instanceof HTMLElement){const percent=FREE_SHIPPING_THRESHOLD!=null&&FREE_SHIPPING_THRESHOLD>0?cartTotalPrice/FREE_SHIPPING_THRESHOLD:0,progressTotal=percent>=100?progressWrap.offsetWidth:percent/100*progressWrap.offsetWidth;wrap.style.width=`${progressTotal}px`,wrap.animate({left:`${progressTotal}px`},2500)}})(),(()=>{const freeShippingDifference=FREE_SHIPPING_THRESHOLD!=null?100*FREE_SHIPPING_THRESHOLD-cartTotalPrice:null;setFreeShippingLabel(freeShippingDifference!=null&&freeShippingDifference<=0?"Free standard shipping unlocked":`${freeShippingMessageBefore} ${(0,format_money.formatMoney)(freeShippingDifference??0,moneyFormat)} ${freeShippingMessage}`)})())},[name,cart2,cartTotalPrice,FREE_SHIPPING_THRESHOLD,freeShippingMessageBefore,moneyFormat,freeShippingMessage]),(0,react.useEffect)(()=>{if(freeGiftSettings&&freeGiftSettings.is_free_gift_enabled&&hasRemovedFreeItemFromCart===!1){const freeItemInCart=cart2?.items.find(item=>item.variant_id===freeGiftSettings.variant_id),requiredRequisiteQuantity=freeGiftSettings.free_gift_requisite_quantity||1e4,requisiteItemIgnoringQuantityInCart=cart2?.items.find(item=>{var _ref;return(_ref=freeGiftSettings.free_gift_requisite_product_no_qty||[])===null||_ref===void 0?void 0:_ref.includes(item.product_id||0)}),requisiteItemQuantityInCart=cart2?.items.reduce((acc,item)=>{var _ref;return!((_ref=freeGiftSettings.free_gift_requisite_products||[])===null||_ref===void 0)&&_ref.includes(item.product_id||0)?acc+item.quantity:acc},0)||0,isQualifiedForFreeGift=!!requisiteItemIgnoringQuantityInCart||requisiteItemQuantityInCart>=requiredRequisiteQuantity;freeItemInCart&&!isQualifiedForFreeGift&&freeGiftSettings.variant_id&&machine2.removeItems({lineItemKeys:[freeItemInCart.key]}),!freeItemInCart&&isQualifiedForFreeGift&&new Promise((resolve,reject)=>{freeGiftSettings.variant_id!=null?machine2.addItems({resolve,reject,input:{items:[{id:freeGiftSettings.variant_id,quantity:1,properties:{_free_gift:!0}}]}}):reject(new Error("No free gift variant ID found"))}).catch(err=>{console.error("Error adding free gift",err)})}},[cart2,freeGiftSettings,machine2,hasRemovedFreeItemFromCart]),(0,react.useEffect)(()=>{(async()=>{var _window_Shopify,_window_Shopify_routes;const root=(window==null||(_window_Shopify=window.Shopify)===null||_window_Shopify===void 0||(_window_Shopify_routes=_window_Shopify.routes)===null||_window_Shopify_routes===void 0?void 0:_window_Shopify_routes.root)||"";(0,get_ajax_section.getAjaxSection)(`${window.location.origin}${root}`,{sections:"ajax-cart-data"}).then(res=>{const data=res["ajax-cart-data"];var _parsedState_querySelector;return data&&((_parsedState_querySelector=new DOMParser().parseFromString(data,"text/html").querySelector(".shopify-section #js-cart-data"))===null||_parsedState_querySelector===void 0?void 0:_parsedState_querySelector.innerHTML)||null}).then(res=>{if(res!==null)try{const cartData=CartData.create(JSON.parse(res));setExtraCartData(cartData)}catch(err){console.error("Error parsing extra cart data",err)}})})()},[cart2]),(0,react.useEffect)(()=>{const verifyFreeGiftAvailability=()=>{if(freeGiftSettings){const freeItemInCart=cart2?.items.find(item=>item.variant_id===freeGiftSettings.variant_id);if(freeItemInCart){var _window_Shopify,_window_Shopify_routes;const root=(window==null||(_window_Shopify=window.Shopify)===null||_window_Shopify===void 0||(_window_Shopify_routes=_window_Shopify.routes)===null||_window_Shopify_routes===void 0?void 0:_window_Shopify_routes.root)||"";(0,get_ajax_section.getAjaxSection)(`${window.location.origin}${root}products/${freeItemInCart.handle}`,{sections:"ajax-product-quantity"}).then(res=>{const data=res["ajax-product-quantity"];var _parsedState_querySelector;return data&&((_parsedState_querySelector=new DOMParser().parseFromString(data,"text/html").querySelector(".shopify-section #js-product-quantity"))===null||_parsedState_querySelector===void 0?void 0:_parsedState_querySelector.innerHTML)||null}).then(res=>{res!==null&&(CartQuantityData.create(JSON.parse(res)).available||(machine2.removeItems({lineItemKeys:[freeItemInCart.key]}),setHasRemovedFreeItemFromCart(!0)))})}}},interval=setInterval(()=>{verifyFreeGiftAvailability()},5e3);return verifyFreeGiftAvailability(),()=>clearInterval(interval)},[cart2,freeGiftSettings,machine2,hasRemovedFreeItemFromCart]),(0,react.useEffect)(()=>{cart_helpers.DUPLICATE_ITEM_REPLACEMENT_DATA.forEach(({baseItemId,duplicateItemId})=>{const duplicateItemsInCart=cart2?.items.filter(({variant_id})=>variant_id===duplicateItemId);duplicateItemsInCart?.forEach(({key,quantity,properties})=>{fetch("/cart/change.js",{headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:0,id:key}),method:"POST"}).then(()=>new Promise((resolve,reject)=>{machine2.addItems({resolve,reject,input:{items:[{id:baseItemId,quantity,properties:{...properties}}]}})})).catch(err=>{console.error("Error replacing duplicate item",err)})})})},[cart2,machine2]),(0,react.useEffect)(()=>{(()=>{if(!cart2)return;const itemsWithNoteProperty=cart2.items.filter(item=>(0,cart_helpers.parseLineItemProperties)(item.properties).find(([key])=>key==="Note")),updates=[];itemsWithNoteProperty.forEach(item=>{const sameItemsWithoutNotes=cart2.items.filter(cartItem=>{const itemProperties=(0,cart_helpers.parseLineItemProperties)(cartItem.properties);return cartItem.variant_id===item.variant_id&&!itemProperties.find(([key])=>key==="Note")});sameItemsWithoutNotes.length>0&&sameItemsWithoutNotes.forEach(itemToUpdate=>{updates.push({id:itemToUpdate.key,quantity:itemToUpdate.quantity,properties:{...itemToUpdate.properties,...item.properties}})})}),updates.length>0&&machine2.changeProperties({items:updates})})()},[cart2,machine2]);const getQtyLimit=(0,react.useCallback)(variantId=>{var _extraCartData_items_find,_extraCartData_items_find1;const variantQtyLimit=(_extraCartData_items_find=extraCartData?.items.find(item=>item.variant_id===variantId))===null||_extraCartData_items_find===void 0?void 0:_extraCartData_items_find.variant_quantity_limit;return variantQtyLimit&&variantQtyLimit>0?variantQtyLimit:((_extraCartData_items_find1=extraCartData?.items.find(item=>item.variant_id===variantId))===null||_extraCartData_items_find1===void 0?void 0:_extraCartData_items_find1.quantity_limit)||10},[extraCartData]);return react.createElement("div",{className:"Cart"},react.createElement("div",null,react.createElement("h1",{className:"u-hSize--Larger Cart-title",dangerouslySetInnerHTML:{__html:cart2?.items.length?"Your <b>CART</b>":""}}),hasRemovedFreeItemFromCart&&react.createElement("p",{className:"CartDrawer-freeItemRemovedMessage",style:{width:"100%",padding:0,textAlign:"left"}},freeGiftSettings?.free_gift_removed_from_cart_message),react.createElement("ul",{className:"CartDrawer-items"},(parsedCartItems??[]).map(item=>{var _extraCartData_items_find,_giftWrapSettings_gift_wrap_product;const isCustomBundle=(0,dist.is)(item,schema_item.BundleItem),bundleItemQtylimit=getQtyLimit(item.variant_id);var _item_properties,_giftWrapSettings_gift_wrap_drawer_drawer_text,_giftWrapSettings_enable_free_product;return isCustomBundle?react.createElement("li",{key:item.key,className:"CartDrawer-item"},react.createElement(bundle_item.BundleDrawerItem,{item,items:cart2?.items||[],moneyFormat,changeQuantity:payload=>{setIsLoading(!0),machine2.changeQuantity(payload),(()=>{const isAddingItemsInterval=setInterval(()=>{if(machine2.isAddItemsAllowed())return setIsLoading(!1),void clearInterval(isAddingItemsInterval)},500)})()},isLoading,cartLimitNo:Number((_item_properties=item.properties)===null||_item_properties===void 0?void 0:_item_properties._custom_bundle_limit_qty)||5,bundleItemQtylimit})):cart_helpers.DUPLICATE_ITEM_REPLACEMENT_DATA.find(({duplicateItemId})=>item.variant_id===duplicateItemId)?react.createElement("li",{key:item.key}):react.createElement("li",{key:item.key,className:"CartDrawer-item"},react.createElement(CartDrawerItem,{item,items:cart2?.items||[],moneyFormat,cartMaxVariantsLimit:(_extraCartData_items_find=extraCartData?.items.find(itemExtraData=>itemExtraData.variant_id===item.variant_id))===null||_extraCartData_items_find===void 0?void 0:_extraCartData_items_find.max_variants_limit,isGiftBag:item.product_id===(giftWrapSettings==null||(_giftWrapSettings_gift_wrap_product=giftWrapSettings.gift_wrap_product)===null||_giftWrapSettings_gift_wrap_product===void 0?void 0:_giftWrapSettings_gift_wrap_product.product_id),giftBagDescription:(_giftWrapSettings_gift_wrap_drawer_drawer_text=giftWrapSettings?.gift_wrap_drawer.drawer_text)!==null&&_giftWrapSettings_gift_wrap_drawer_drawer_text!==void 0?_giftWrapSettings_gift_wrap_drawer_drawer_text:"",isFreeGiftBagEnabled:(_giftWrapSettings_enable_free_product=giftWrapSettings?.enable_free_product)!==null&&_giftWrapSettings_enable_free_product!==void 0&&_giftWrapSettings_enable_free_product,changeQuantity:payload=>{machine2.changeQuantity(payload)},cartLimitNo:getQtyLimit(item.variant_id)}))}))),react.createElement("div",{className:"Cart-side-content u-white"},react.createElement("div",{className:"CartDrawer-container"},react.createElement("p",{className:"CartDrawer-titleLink u-noMargin"},drawerTitle),freeShippingSwitch&&react.createElement("p",{className:"u-noMargin"},react.createElement("div",{className:"Cart-progressWrap progress"},react.createElement("div",{className:"Cart-progressBar progress"})),react.createElement("span",{className:"CartDrawer-shippingLabel",dangerouslySetInnerHTML:{__html:freeShippingLabel}}))),react.createElement("div",{className:"CartDrawer-summary"},react.createElement("div",{className:"CartDrawer-subtotalContainer"},react.createElement("div",{className:"CartDrawer-subtotalLabel",dangerouslySetInnerHTML:{__html:app_locale.subtotal}}),react.createElement("div",{className:"CartDrawer-subtotal"},(0,format_money.formatMoney)(cart2?.total_price||0,moneyFormat))),react.createElement("p",{className:"CartDrawer-shippingAtCheckout"},app_locale.shippingAtCheckout),giftWrapSettings&&giftWrapSettings.enabled?react.createElement(gift_wrap.GiftWrap,{extraCartData,cartItems:cart2?.items||[],giftWrapSettings,moneyFormat,machine:machine2,totalCartPrice:cart2?.total_price||0,isCartPage:!0}):null,react.createElement("div",{className:"CartDrawer-buttonWrapper"},react.createElement(components_button.Button,{mode:buttonMode,element:"a",modifiers:"Button__white Button__fullWidth Button__large",label:app_locale.checkout,href:"/checkout"})),react.createElement("div",{className:"CartDrawer-error"},error?error.message:warning||""))))};var app=__webpack_require__("90ffb912087cdbb9c1bc"),traversal=__webpack_require__("b56a16cdaeb8dc9b98d0"),client=__webpack_require__("3d479b4036d2a7cbfefc"),modern_queryClient=__webpack_require__("2c4e2dc07734c3611524"),QueryClientProvider=__webpack_require__("d2b5c40afcc76792ecdf");function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}var cart=__webpack_require__("ab83936d5e4547a34b1f"),lib=__webpack_require__("6aee42c69a7e093df30d"),app_error=__webpack_require__("fde6f9c42ddcf1103907");let activated=!1;const logErrors=function(err){console.error(err)},machine=(0,cart.getCartMachine)();activated||(lib.Machine.addMiddleware({onStateChanged(){this.state.name.toLowerCase().includes("failure")&&console.warn(`"${this.name}" machine state changed to ${this.state.name}`);const _err="error"in this.state?this.state.error:null,err=_err instanceof Error?_err:typeof _err=="string"?new Error(_err):null;err&&console.error(err,err instanceof app_error.AppError?err.details:null)}}),activated=!0),machine.init(),async function(machine2){(machine22=>{(0,helpers.connect)().with(machine22.name).map(function(m){(function(state){if(state.name!=="Ready")return;const cartItemCountElements=document.querySelectorAll(".js-cart-item-count");cartItemCountElements.length!==0&&cartItemCountElements.forEach(cartItemCountElement=>{if(!(cartItemCountElement instanceof HTMLElement))return;const itemsQty=state.contents.items.reduce((acc,cartItem)=>{var _cartItem_properties;if(!((_cartItem_properties=cartItem.properties)===null||_cartItem_properties===void 0)&&_cartItem_properties._custom_bundle_uid){const bundleSize=Number(cartItem.properties._custom_bundle_size)||4;return acc+cartItem.quantity/bundleSize}return acc+cartItem.quantity},0).toFixed(0);cartItemCountElement.textContent=itemsQty.toString(),cartItemCountElement.setAttribute("data-size",`${itemsQty}`.length.toString())})})(m.state)})})(machine2)}(machine).catch(logErrors),async function(machine2){var _findOneElement;const queryClient=new modern_queryClient.QueryClient,target=(0,traversal.findOneElement)(document,"#js-cart-page-desktop"),mobileTarget=(0,traversal.findOneElement)(document,"#js-cart-page-mobile"),rawIo=((_findOneElement=(0,traversal.findOneElement)(target,'script[type="application/json"]'))===null||_findOneElement===void 0?void 0:_findOneElement.textContent)||"{}";if(!target||!mobileTarget)return;const{moneyFormat,cartTitle,freeShippingThreshold,freeShippingMessageBefore,freeShippingMessage,upsellProducts,upsellCollectionProducts,upsellCollectionImages,freeShippingSwitch,buttonMode,freeGiftSettings,upsellCollectionNotes,giftWrapSettings}=CartDrawerIO.create(JSON.parse(rawIo));(0,client.createRoot)(target).render(react.createElement(App,_extends({},{machine:machine2,moneyFormat,cartTitle,freeShippingThreshold,freeShippingMessage,freeShippingMessageBefore,freeShippingSwitch,buttonMode,freeGiftSettings,giftWrapSettings}))),(0,client.createRoot)(mobileTarget).render(react.createElement(QueryClientProvider.QueryClientProvider,{client:queryClient},react.createElement(app.App,_extends({},{machine:machine2,moneyFormat,cartTitle,freeShippingThreshold,freeShippingMessage,upsellProducts,upsellCollectionProducts,upsellCollectionImages,upsellCollectionNotes,freeShippingSwitch,freeShippingMessageBefore,buttonMode,freeGiftSettings,rebuy_endpoint:null,upsellProductsExtraData:[],giftWrapSettings,isMobileCartPage:!0}))))}(machine).catch(logErrors)}},__webpack_require__=>{__webpack_require__.O(0,[351,502,945,511,642,794,902,548,462,275],()=>__webpack_require__(__webpack_require__.s="23c96b82ee364a9c5a22")),__webpack_require__.O()}]);
//# sourceMappingURL=/cdn/shop/t/1074/assets/theme-cart.js.map?v=112961131417520517501761066877
