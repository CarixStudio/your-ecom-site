(function(){function t(e,a,o,i){Object.defineProperty(e,a,{get:o,set:i,enumerable:!0,configurable:!0})}var ie=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},re={},X={},r=ie.parcelRequire94c2;r==null&&(r=function(e){if(e in re)return re[e].exports;if(e in X){var a=X[e];delete X[e];var o={id:e,exports:{}};return re[e]=o,a.call(o.exports,o,o.exports),o.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i},r.register=function(a,o){X[a]=o},ie.parcelRequire94c2=r);var y=r.register;y("jHnDr",function(e,a){t(e.exports,"register",function(){return o},function(u){return o=u}),t(e.exports,"resolve",function(){return i},function(u){return i=u});var o,i,n=new Map;function c(u,l){for(var T=0;T<l.length-1;T+=2)n.set(l[T],{baseUrl:u,path:l[T+1]})}function s(u){var l=n.get(u);if(l==null)throw new Error("Could not resolve bundle with id "+u);return new URL(l.path,l.baseUrl).toString()}o=c,i=s}),y("2372k",function(e,a){t(e.exports,"getBundleURL",function(){return o},function(_){return o=_});var o,i,n,c={};function s(_){var d=c[_];return d||(d=u(),c[_]=d),d}function u(){try{throw new Error}catch(d){var _=(""+d.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(_)return l(_[2])}return"/"}function l(_){return(""+_).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}function T(_){var d=(""+_).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!d)throw new Error("Origin not found");return d[0]}o=s,i=l,n=T}),y("aQK74",function(e,a){t(e.exports,"sendAnalyticsToExternalSource",function(){return $}),t(e.exports,"setImpressionByPublishId",function(){return R}),t(e.exports,"registerSiteActivityListenerIfNeeded",function(){return b}),t(e.exports,"sendPageVisitEvent",function(){return j});var o=r("50h3S"),i=r("8ptJJ"),n=r("kCbDV"),c=r("bvKjB"),s=r("93NPo"),u=r("dNsZ9"),l=r("tZRsn"),T=r("i1NbZ"),_=r("kK0IS"),d=r("eSOI5"),I=r("6QfcD"),O=r("izL3O");const S=864e5,v=h=>`tolstoy${(0,s.uppercaseFirstChar)(h)}`,$=h=>{(0,s.verifyUserConsent)()&&(U(h),x(h))},x=h=>{const{data:{name:A,text:p,facebookAnalyticsID:g,playlist:w,collectInfoType:V}}=h;if(!window.fbq||!g||!w)return;const k=`tolstoy-${w}`;switch(A){case o.PLAYER_EVENT_NAMES.sessionStart:C(g,`${k}-click`,{value:"Start Tolstoy"});break;case o.PLAYER_EVENT_NAMES.clickCta:C(g,`${k}-click`,{value:p});break;case o.PLAYER_EVENT_NAMES.submitInput:C(g,`${k}-input`,{value:p});break;case o.PLAYER_EVENT_NAMES.collectInfo:C(g,`${k}-${o.PLAYER_EVENTS.collectInfo}`,{value:V});break;case o.PLAYER_EVENT_NAMES.videoResponse:C(g,`${k}-${o.PLAYER_EVENTS.videoResponse}`);break;case o.PLAYER_EVENT_NAMES.imageResponse:C(g,`${k}-${o.PLAYER_EVENTS.imageResponse}`);break;case o.PLAYER_EVENT_NAMES.audioResponse:C(g,`${k}-${o.PLAYER_EVENTS.audioResponse}`);break;case o.PLAYER_EVENTS.sessionEnd:C(g,`${k}-${o.PLAYER_EVENTS.sessionEnd}`);break}},C=(h,A,p)=>{window.fbq("trackSingleCustom",h,A,p)},U=h=>{const{data:{name:A,text:p,googleAnalyticsID:g,playlist:w,collectInfoType:V,productNames:k,totalTime:K,videoName:z,type:Q,direction:Z}}=h;if(!window.gtag&&!window.dataLayer&&!window.ga||!g||!w)return;const F=`tolstoy-${w}`;switch(A){case c.EVENT_NAMES.pageView:break;case o.PLAYER_EVENTS.sessionStart:case o.PLAYER_EVENT_NAMES.sessionStart:P(g,F,o.PLAYER_EVENT_NAMES.sessionStart),P(g,F,"click","Start Tolstoy");break;case o.PLAYER_EVENT_NAMES.clickCta:P(g,F,A,p);break;case o.PLAYER_EVENT_NAMES.collectInfo:P(g,F,A,V);break;case o.PLAYER_EVENT_NAMES.submitInput:case o.PLAYER_EVENT_NAMES.imageResponse:case o.PLAYER_EVENT_NAMES.audioResponse:case o.PLAYER_EVENT_NAMES.videoResponse:case o.PLAYER_EVENT_NAMES.sessionEnd:P(g,F,A);break;case c.EVENT_NAMES.tolstoyModalClose:P(g,F,c.EVENT_NAMES.tolstoyModalClose,K);break;case c.EVENT_NAMES.videoLoaded:k&&P(g,F,"tolstoyVideoLoaded-products",k),P(g,F,"tolstoyVideoLoaded-videoName",z);break;case c.EVENT_NAMES.feedProductModalOpen:case c.EVENT_NAMES.feedProductModalClose:case c.EVENT_NAMES.clickViewProduct:case c.EVENT_NAMES.openProductPageClick:P(g,F,v(A),k);break;case c.EVENT_NAMES.feedPlay:case c.EVENT_NAMES.feedPause:case c.EVENT_NAMES.videoMuted:case c.EVENT_NAMES.videoUnmuted:case c.EVENT_NAMES.videoWatched:P(g,F,v(A),z);break;case c.EVENT_NAMES.openShareLink:P(g,F,v("openShareLink"),Q);break;case c.EVENT_NAMES.feedNavigationArrowClick:case c.EVENT_NAMES.feedScroll:P(g,F,v(A),Z);break;default:P(g,F,v(A),p)}},P=(h,A,p,g)=>{(0,s.verifyUserConsent)()&&(window.gtag?window.gtag("event",p,{event_category:A,event_label:g,send_to:h}):window.dataLayer&&window.dataLayer.push({event:p,event_category:A,event_label:g,send_to:h}))},Y={},R=(h,A)=>{Y[h]=Y[h]||A};let E=!1;const b=()=>{if(!E)try{const h=(0,I.getAppKey)();N({appKey:h}),E=!0}catch(h){console.error(h),window.tolstoyCaptureError?.(h)}},N=({appKey:h}={})=>{let A=0,p=!1;if((0,d.setNotVisibileOpenedTolstoyPublishId)(null),!(0,u.validateUUID)(h))return;const g=({now:w,performanceNow:V})=>{p=!1;let k=(0,d.getTolstoysActivity)();H(w,k),k=(0,d.getTolstoysActivity)();const K=Math.round(V-A),z=(0,d.getSessionUniqueId)(),Q=B(k),Z=window.location.href.split("?")[0],F=(0,T.getCurrentPageProductId)(),ce={appKey:h,sessionUniqueId:z,timestamp:new Date().toISOString(),anonymousId:(0,d.getAndSetAnonymousId)(),storeUrl:(0,O.getShop)(),siteActivity:Q,eventName:n.SITE_ACTIVITY_EVENT_NAME,timeOnPage:K,pageUrl:Z,currentPageProductId:F};(0,_.createSiteActivityEvent)(ce),p=!0,(0,d.clearTolstoyActivity)()};document.addEventListener("visibilitychange",()=>{try{const w=Date.now(),V=window.performance.now();document.visibilityState==="visible"&&(A=V,p=!1,D(w)),document.visibilityState==="hidden"&&!p&&g({now:w,performanceNow:V})}catch(w){console.error(w),window.tolstoyCaptureError?.(w)}}),window.addEventListener("beforeunload",()=>{if(!p)try{const w=Date.now(),V=window.performance.now();g({now:w,performanceNow:V})}catch(w){console.error(w),window.tolstoyCaptureError?.(w)}})},B=h=>{const A={};for(const[p,g]of Object.entries(Y)){const w=h[p];!w?.length&&!A[p]&&(A[p]={activity:{},totalTime:0,impression:g});const V=m({publishId:p,activities:w});let k=0;for(const K of Object.values(V))k+=K;A[p]={activity:V,totalTime:k,impression:g}}return A},m=({publishId:h,activities:A})=>{if(!h||!A?.length)return{};const p=Date.now(),g={},w={};for(const{timeStamp:V,type:k,sessionId:K}of A)w[K]=w[K]||0,g[K]===void 0&&(g[K]=!1),(0,l.getIsActiveWidgetEvent)(k)&&!g[K]&&(g[K]=!0,w[K]-=V),(0,l.getIsInactiveWidgetEvent)(k)&&g[K]&&(g[K]=!1,w[K]+=V);for(const[V,k]of Object.entries(g))k&&(w[V]+=p),(w[V]<=0||w[V]>S)&&delete w[V];return w},L=h=>Object.entries(h).find(([A,p])=>{if(p.length===0)return;const g=p[p.length-1].type;return(0,l.getIsActiveWidgetEvent)(g)})?.[0],D=h=>{const A=(0,d.getNotVisibleOpenedTolstoyPublishId)(),p=(0,d.getSessionId)();!A||!p||((0,d.pushTolstoyActivity)({publishId:A,timeStamp:h,type:i.WIDGET_MESSAGES_EVENTS.OPEN,sessionId:p}),(0,d.setNotVisibileOpenedTolstoyPublishId)(null))},H=(h,A)=>{const p=L(A),g=(0,d.getSessionId)();!p||!g||((0,d.pushTolstoyActivity)({publishId:p,timeStamp:h,type:i.WIDGET_MESSAGES_EVENTS.CLOSE,sessionId:g}),(0,d.setNotVisibileOpenedTolstoyPublishId)(p))},j=()=>{const h=(0,I.getAppKey)();if(!h)return;const A=window.location.href.split("?")[0],p=(0,T.getCurrentPageProductId)(),g={appKey:h,sessionUniqueId:(0,d.getSessionUniqueId)(),createdAt:new Date().toISOString(),anonymousId:(0,d.getAndSetAnonymousId)(),appUrl:(0,O.getShop)(),eventName:n.PAGE_VISIT_EVENT_NAME,parentUrl:A,currentPageProductId:p};(0,_.createPageVisitEvent)(g)}}),y("50h3S",function(e,a){t(e.exports,"PLAYER_EVENTS",function(){return o}),t(e.exports,"PLAYER_EVENT_NAMES",function(){return i});const o={pageView:"pageView",sessionStart:"sessionStart",sessionEnd:"sessionEnd",videoPause:"videoPause",videoStart:"videoStart",videoResume:"videoResume",videoReplay:"videoReplay",clickCta:"clickCta",submitInput:"submitInput",collectInfo:"collectInfo",videoResponse:"videoResponse",audioResponse:"audioResponse",imageResponse:"imageResponse",tolstoyClick:"tolstoyClick",chapterSelected:"chapterSelected",chapterPickerOpened:"chapterPickerOpened",videoSeeked:"videoSeeked",shareClick:"shareClick",quizResult:"quizResult",autoplayStart:"autoplayStart"},i={sessionStart:"tolstoyStarted",sessionEnd:"tolstoyReachedEnd",clickCta:"tolstoyAnswerClicked",submitInput:"tolstoyInputSubmit",collectInfo:"tolstoyLeadFormSubmit",videoResponse:"tolstoyVideoSubmit",audioResponse:"tolstoyAudioSubmit",imageResponse:"tolstoyImageSubmit",openGorgias:"tolstoyOpenGorgias",hideGorgias:"tolstoyHideGorgias",openIntercom:"tolstoyOpenIntercom",hideIntercom:"tolstoyHideIntercom",openTawkTo:"tolstoyOpenTawkTo",hideTawkTo:"tolstoyHideTawkTo",openLiveChat:"tolstoyOpenLiveChat",hideLiveChat:"tolstoyHideLiveChat",openHubSpot:"tolstoyOpenHubSpot",hideHubSpot:"tolstoyHideHubSpot",openHelpScout:"tolstoyOpenHelpScout",hideHelpScout:"tolstoyHideHelpScout",openDrift:"tolstoyOpenDrift",hideDrift:"tolstoyHideDrift",openZendesk:"tolstoyOpenZendesk",hideZendesk:"tolstoyHideZendesk"}}),y("8ptJJ",function(e,a){t(e.exports,"TOLSTOY_ESCAPE_KEY_PRESSED_MESSAGE",function(){return o}),t(e.exports,"TOLSTOY_WATCHED_PRODUCT_IDS_MESSAGE",function(){return i}),t(e.exports,"SHOW_FEED_PRODUCT_MODAL_MESSAGE",function(){return n}),t(e.exports,"WIDGETS_MESSAGES",function(){return c}),t(e.exports,"SHOW_FEED_CART_MOBILE_MESSAGE",function(){return s}),t(e.exports,"TOLSTOY_MOVE_TO_URL",function(){return u}),t(e.exports,"TOLSTOY_CLOSE_MODAL_MESSAGE",function(){return l}),t(e.exports,"TOLSTOY_PLAYER_READY_MESSAGE",function(){return T}),t(e.exports,"FOCUS_CLOSE_BUTTON_MESSAGE",function(){return _}),t(e.exports,"WIDGET_MESSAGES_EVENTS",function(){return d}),t(e.exports,"ACTIVE_WIDGET_MESSAGES_EVENTS",function(){return I}),t(e.exports,"INACTIVE_WIDGET_MESSAGES_EVENTS",function(){return O}),t(e.exports,"PRE_CONFIG_MESSAGES",function(){return S}),t(e.exports,"RECHARGE_MESSAGING",function(){return v}),t(e.exports,"RECHARGE_WIDGET_DATA_MESSAGE",function(){return $}),t(e.exports,"REQUEST_RECHARGE_WIDGET_DATA_MESSAGE",function(){return x}),t(e.exports,"REQUEST_RECHARGE_ADD_TO_CART_MESSAGE",function(){return C});const o="tolstoyEscapeKeyPressed",i="tolstoyWatchedProductIds",n="showFeedProductModal",c="tolstoyWidgets",s="showFeedCartMobile",u="tolstoyMoveToUrl",l="tolstoyCloseModalMessage",T="tolstoyPlayerReady",_="focusCloseButton",d={OPEN:"open",CLOSE:"close",PLAY:"play",PAUSE:"pause"},I=[d.OPEN,d.PLAY],O=[d.CLOSE,d.PAUSE],S={ready:"tolstoyPreConfigMessengerReady",vodAssetIds:"tolstoyVodAssetIds"},v="rechargeMessaging",$="tolstoyRechargeWidgetData",x="tolstoyRequestRechargeWidgetData",C="tolstoyRequestRechargeAddToCart",U="tolstoyRechargePostToCartResponse"}),y("kCbDV",function(e,a){t(e.exports,"CAROUSEL_EMBED_WIDGET",function(){return l}),t(e.exports,"IN_TILE_CAROUSEL_EMBED_WIDGET",function(){return T}),t(e.exports,"BUBBLE_WIDGET",function(){return _}),t(e.exports,"STORY_EMBED_WIDGET",function(){return d}),t(e.exports,"EMBED_WIDGET",function(){return I}),t(e.exports,"ON_YOU_WIDGET",function(){return O}),t(e.exports,"TILE_EMBED_WIDGET",function(){return S}),t(e.exports,"CENTERED_MODAL_WIDGET",function(){return v}),t(e.exports,"COLLECTION_TILE_EMBED_WIDGET",function(){return $}),t(e.exports,"COLLECTION_PAGE_TILE_EMBED_WIDGET",function(){return x}),t(e.exports,"STOP_SHOWING_WIDGET_TO",function(){return C}),t(e.exports,"EMBED_WIDGETS_CLASSNAMES",function(){return U}),t(e.exports,"SITE_ACTIVITY_EVENT_NAME",function(){return P}),t(e.exports,"PAGE_VISIT_EVENT_NAME",function(){return Y}),t(e.exports,"DOM_EXCEPTION_ERRORS",function(){return R}),t(e.exports,"DEFAULT_CART_QUANTITY",function(){return E}),t(e.exports,"WIDGET_SCRIPT_PARAMETERS",function(){return b}),t(e.exports,"URL_PARAMETERS",function(){return N}),t(e.exports,"PLACEHOLDER_PRODUCT_ID",function(){return B}),t(e.exports,"CAROUSEL_CREATOR_PROFILE_LINK_POSITION",function(){return m});var o=r("iG8TK"),i=r("hRKjm"),n=r("99pD6"),c=r("lPPKE"),s=r("4lhba"),u=r("fgRdL");const l="carousel",T="inTileCarousel",_="bubble",d="stories",I="embed",O="onYou",S="tile",v="centeredModal",$="collectionTile",x="collectionPageTile",C={clickedX:"stopShowingWidgetToClickedX",viewed:"stopShowingWidgetToViewed"},U={[l]:o.PUBLIC_CLASSES.carousel,[d]:n.PUBLIC_CLASSES.story,[I]:i.PUBLIC_CLASSES.embed,[S]:c.PUBLIC_CLASSES.tile,[$]:s.PUBLIC_CLASSES.collectionTile,[x]:u.PUBLIC_CLASS},P="siteActivity",Y="pageVisit",R={notAllowedError:"NotAllowedError",abortError:"AbortError"},E=1,b={shop:"shop",appKey:"app-key",productId:"product-id",shouldUseCache:"should-use-cache",cacheVersion:"cache-version"},N={tolstoyAutoOpen:"tolstoyAutoOpen",tolstoyAutoOpenOnYou:"autoOpenOnYou",tolstoyStartVideo:"tolstoyStartVideo",tolstoyMoneyFormat:"tolstoyMoneyFormat"},B="PRODUCT_ID",m={TOP:"top",BOTTOM:"bottom"}}),y("iG8TK",function(e,a){t(e.exports,"EMBED_CAROUSEL_MOTION",function(){return o}),t(e.exports,"CAROUSEL_TILE_NAME_LOCATION_TYPES",function(){return i}),t(e.exports,"PUBLIC_CLASSES",function(){return n}),t(e.exports,"MAX_TILE_NUMBER",function(){return c}),t(e.exports,"MIN_TILE_NUMBER",function(){return s}),t(e.exports,"MIN_WIDTH_FOR_TILE",function(){return u}),t(e.exports,"DEFAULT_DOT_OPACITY",function(){return l}),t(e.exports,"TILE_NAME_HEIGHT",function(){return T}),t(e.exports,"SPACING_HORIZONTAL",function(){return _}),t(e.exports,"DEFAULT_TILE_HEIGHT",function(){return d}),t(e.exports,"CAROUSEL_TYPE",function(){return I}),t(e.exports,"SPOTLIGHT_CAROUSEL_CONTENT_TILE_TYPE",function(){return O}),t(e.exports,"CAROUSEL_TITLE",function(){return S}),t(e.exports,"CAROUSEL_ARROW_CLICK_MODE",function(){return v});const o={static:"static",dynamic:"dynamic",hoverOver:"hoverOver"},i={under:"under",over:"over"},n={carousel:"tolstoy-carousel",carouselContainer:"tolstoy-carousel-container",title:"tolstoy-carousel-title",videoCarouselContainer:"tolstoy-video-carousel-container",previousButton:"tolstoy-previous-button",nextButton:"tolstoy-next-button",arrowsContainer:"tolstoy-carousel-arrows-container",videosContainer:"tolstoy-carousel-videos-container",videoContainer:"tolstoy-carousel-video-container",video:"tolstoy-carousel-video",image:"tolstoy-carousel-image",dotsContainer:"tolstoy-dots-container",dot:"tolstoy-dot",playButtonContainer:"tolstoy-play-button-container",controlsContainer:"tolstoy-carousel-controls-container",expandButton:"tolstoy-carousel-expand-button",muteButton:"tolstoy-carousel-mute-button",playButton:"tolstoy-carousel-play-button",tileContainer:"tolstoy-carousel-tile-container",tile:"tolstoy-carousel-tile",centerTile:"tolstoy-carousel-center-tile",tileNameContainer:"tolstoy-tile-name-container",tileNameText:"tolstoy-carousel-tile-name-text",arrowButtonContainer:"tolstoy-carousel-arrow-button-container",arrowButton:"tolstoy-carousel-arrow-button",tileNameHeightPlaceholder:"tolstoy-tile-name-height-placeholder",productTile:"tolstoy-product-tile",productContent:"tolstoy-product-content",productTileImage:"tolstoy-product-tile-image",productTileTitle:"tolstoy-product-tile-title",tileText:"tolstoy-tile-text",variantTile:"tolstoy-product-variant-tile",variantTileIcon:"tolstoy-product-variant-tile-icon",variantTileTitle:"tolstoy-product-variant-tile-title",productTilePrice:"tolstoy-product-tile-price",productTileSubtitle:"tolstoy-product-tile-subtitle",productTileButton:"tolstoy-product-tile-button",productTileArrow:"tolstoy-product-tile-arrow",productTileFallback:"tolstoy-product-tile-fallback",descriptionTile:"tolstoy-description-tile",descriptionTileContent:"tolstoy-description-tile-content",descriptionTileButton:"tolstoy-description-tile-button",progressBarContainer:"tolstoy-carousel-progress-bar-container",progressBar:"tolstoy-carousel-progress-bar"},c=6,s=2,u=80,l=.3,T=80,_=12,d=416,I={DEFAULT:"default",SPOTLIGHT:"spotlight"},O={product:"product",videoName:"videoName",none:"none"},S={shoppableVideoCarousel:"Shoppable Video Carousel",viewProduct:"View Product"},v={SCROLLS_CAROUSEL:"scrollsCarousel",SCROLLS_VIDEO:"scrollsVideo"}}),y("hRKjm",function(e,a){t(e.exports,"PUBLIC_CLASSES",function(){return o}),t(e.exports,"ASPECT_RATIO_9_16",function(){return i});const o={embed:"tolstoy-embed",iframe:"tolstoy-embed-iframe",videoPreview:"tolstoy-embed-video-preview",videoContainer:"tolstoy-embed-video-container",playButtonContainer:"tolstoy-embed-play-button-container",startText:"tolstoy-embed-start-text",startButtonContainer:"tolstoy-embed-start-button-container",startButton:"tolstoy-embed-start-button",embedContainer:"tolstoy-embed-container"},i=9/16}),y("99pD6",function(e,a){t(e.exports,"PUBLIC_CLASSES",function(){return i}),t(e.exports,"POSTER_SUFFIX",function(){return n}),t(e.exports,"STORIES_IMAGE_EXTENSION",function(){return s}),t(e.exports,"EMBED_STORY_MOTION",function(){return u}),t(e.exports,"STORIES_ITEMS_SIZE_TYPES",function(){return l}),t(e.exports,"STORIES_NAME_LOCATION",function(){return T}),t(e.exports,"DEFAULT_STORIES_ITEMS_SIZE_TYPE",function(){return _}),t(e.exports,"DEFAULT_STORIES_ITEMS_PER_ROW",function(){return d}),t(e.exports,"DEFAULT_STORIES_SIZE",function(){return I}),t(e.exports,"DEFAULT_STORIES_SPACING",function(){return O}),t(e.exports,"STORIES_ITEM_MAX_FIXED_SIZE",function(){return S}),t(e.exports,"STORIES_HIGHER_IMAGE_RESOLUTION_SIZE",function(){return v});var o=r("iG8TK");const i={story:"tolstoy-stories",storiesMainContainer:"tolstoy-stories-main-container",storiesContainer:"tolstoy-stories-container",tilesContainer:"tolstoy-stories-tiles-container",tileName:"tolstoy-stories-tile-name",storyTile:"tolstoy-stories-tile",storyImage:"tolstoy-stories-story-image",storyVideo:"tolstoy-stories-story-video",plusTile:"tolstoy-stories-plus-tile",storyName:"tolstoy-stories-story-name",titleContainer:"tolstoy-stories-title",plusTileContainer:"tolstoy-stories-plus-tile-container",previousButton:"tolstoy-stories-previous-button",nextButton:"tolstoy-stories-next-button",onYouButton:"tolstoy-stories-on-you-button",onlyOnYouButton:"tolstoy-stories-only-on-you-button",playButtonContainer:"tolstoy-stories-play-button-container"},n=".0000000.jpg",s=`.avatar${n}`,u={static:o.EMBED_CAROUSEL_MOTION.static,dynamic:o.EMBED_CAROUSEL_MOTION.dynamic},l={responsive:"responsive",fixed:"fixed"},T={below:"below",overlay:"overlay"},_=l.fixed,d=8,I=80,O=8,S=240,v=200}),y("lPPKE",function(e,a){t(e.exports,"PUBLIC_CLASSES",function(){return o});const o={tile:"tolstoy-tile",tileContainer:"tolstoy-tile-container",video:"tolstoy-tile-video",nativeCaptionsTrack:"tolstoy-tile-native-captions-track",customCaptionsTrack:"tolstoy-tile-custom-captions-track",imageOverlay:"tolstoy-tile-image-overlay",image:"tolstoy-tile-image",controlsOverlay:"tolstoy-tile-controls-overlay",controlsContainer:"tolstoy-tile-controls",playButtonOverlay:"tolstoy-tile-play-button-overlay",playButtonContainer:"tolstoy-tile-play-button-container",playButtonLabelContainer:"tolstoy-tile-play-button-label-container",playButtonLabel:"tolstoy-tile-play-button-label",timebarWrapper:"tolstoy-tile-timebar-wrapper",timebarContainer:"tolstoy-tile-timebar-container",timebar:"tolstoy-tile-timebar",timeIndicator:"tolstoy-tile-time-indicator",muteButton:"tolstoy-tile-mute-button",fullScreenButton:"tolstoy-tile-full-screen-button",togglesContainer:"tolstoy-tile-toggles",captionsButton:"tolstoy-tile-captions-button"}}),y("4lhba",function(e,a){t(e.exports,"PUBLIC_CLASSES",function(){return o}),t(e.exports,"PLAY_MODE",function(){return i}),t(e.exports,"PLAY_VIDEOS",function(){return n}),t(e.exports,"VIDEO_PLAYBACK_MODE",function(){return c}),t(e.exports,"TILE_CLICK_MODE",function(){return s}),t(e.exports,"TILE_DATA_KEY",function(){return u}),t(e.exports,"DEFAULT_SETTINGS",function(){return l});const o={collectionTile:"tolstoy-collection-tile",collectionTileHoverWrapper:"tolstoy-collection-tile-hover-wrapper",video:"tolstoy-collection-tile-video",controlsContainer:"tolstoy-collection-tile-controls-container",playButton:"tolstoy-collection-tile-play-button",muteButton:"tolstoy-collection-tile-mute-button"},i={AUTOPLAY:"autoplay",CLICK:"click",HOVER:"hover"},n={CONSECUTIVELY:"consecutively",SIMULTANEOUSLY:"simultaneously"},c={LOOP:"loop",PLAY_ONCE:"playOnce"},s={PDP:"pdp",PLAY:"play"},u="data-tolstoy-collection-tile-key",l={playMode:i.AUTOPLAY,playVideos:n.CONSECUTIVELY,autoplayDelay:1,minProductsBetweenVideos:2,mutedByDefault:!1,tileClickMode:s.PDP,shouldHideVideoWhenNotPlaying:!0,controls:{play:{enabled:!1,backgroundEnabled:!0,backgroundColor:"#0000004d",borderEnabled:!1,borderColor:"#ffffff",opacity:1},mute:{enabled:!1,backgroundEnabled:!0,backgroundColor:"#0000004d",borderEnabled:!1,borderColor:"#ffffff",opacity:1}}}}),y("fgRdL",function(e,a){t(e.exports,"PUBLIC_CLASS",function(){return i});const o="collectionPageTile",i="tolstoy-collection-page-tile"}),y("bvKjB",function(e,a){t(e.exports,"EVENT_NAMES",function(){return o});const o={embedView:"embedView",embedPlay:"embedPlay",embedPause:"embedPause",embedMute:"embedMute",embedUnmute:"embedUnmute",embedExpand:"embedExpand",tolstoyModalClose:"tolstoyModalClose",feedProductModalOpen:"feedProductModalOpen",feedProductModalClose:"feedProductModalClose",videoLoaded:"videoLoaded",pageView:"pageView",clickViewProduct:"clickViewProduct",openProductPageClick:"openProductPageClick",feedPlay:"feedPlay",feedPause:"feedPause",videoMuted:"videoMuted",videoUnmuted:"videoUnmuted",videoWatched:"videoWatched",openShareLink:"Open Share Link",feedNavigationArrowClick:"feedNavigationArrowClick",feedScroll:"feedScroll",sessionStart:"sessionStart",tolstoyStarted:"tolstoyStarted",abTestInitialized:"abTestInitialized",onYouClick:"onYouClick"}}),y("93NPo",function(e,a){t(e.exports,"uppercaseFirstChar",function(){return c}),t(e.exports,"getSafeParameter",function(){return s}),t(e.exports,"getRandomNumberBetweenTwoIntegers",function(){return u}),t(e.exports,"generateUUID",function(){return l}),t(e.exports,"logDevelopmentMessage",function(){return d}),t(e.exports,"logDevelopmentError",function(){return I}),t(e.exports,"getIsIOS",function(){return O}),t(e.exports,"getIsMobile",function(){return S}),t(e.exports,"debounce",function(){return v}),t(e.exports,"sleep",function(){return $}),t(e.exports,"safeRoundNumber",function(){return x}),t(e.exports,"removeHtmlTags",function(){return C}),t(e.exports,"isNullOrUndefined",function(){return U}),t(e.exports,"formatTime",function(){return P}),t(e.exports,"verifyUserConsent",function(){return Y});var o=r("2Aomz"),i=r("hlJEM"),n=r("lxjfR");const c=R=>R?.length?`${R[0]?.toUpperCase()}${R?.slice(1)}`:"",s=R=>{if(!("URLSearchParams"in window))return null;try{return new URLSearchParams(window.location?.search).get(R)}catch(b){if(b)return null}},u=(R,E)=>Math.floor(Math.random()*(E-R+1))+R,l=()=>{const R=E=>{const b=Math.floor(Math.random()*16);return(E==="x"?b:b&3|8).toString(16)};return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,R)},T=()=>o.NODE_ENV==="development",_=()=>T()||s("td")==="true",d=(...R)=>{_()&&console.log(...R)},I=R=>{_()&&console.error(R)},O=()=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,S=()=>O()||window.screen.width<=450||window.screen.height<=450,v=(R,E=300)=>{let b;return(...N)=>{clearTimeout(b),b=setTimeout(()=>{R(...N)},E)}},$=async(R=0)=>new Promise(E=>{setTimeout(E,R)}),x=(R,E=1)=>{const b=Number(R);return Number.isNaN(b)?0:Number.isInteger(b)?b:Number.parseFloat(b.toFixed(E))},C=R=>R.replace(/<[^>]*>?/gm,""),U=R=>R==null,P=R=>{const E=Math.floor(R/60),b=Math.floor(R%60);return`${E}:${b.toString().padStart(2,"0")}`},Y=()=>(0,n.getCookiePolicy)()===i.COOKIE_POLICIES.rejected?!1:window.Shopify?.customerPrivacy?.currentVisitorConsent?window.Shopify.customerPrivacy.currentVisitorConsent().analytics!=="no":!0}),y("2Aomz",function(e,a){t(e.exports,"API_BASE_URL",function(){return n}),t(e.exports,"API_LB_BASE_URL",function(){return c}),t(e.exports,"API_LB_CDN_BASE_URL",function(){return s}),t(e.exports,"PLAYER_URL",function(){return l}),t(e.exports,"ON_YOU_URL",function(){return T}),t(e.exports,"HERO_URL",function(){return _}),t(e.exports,"WIDGET_DOMAIN",function(){return d}),t(e.exports,"VIDEO_OUTPUT",function(){return I}),t(e.exports,"CREATE_VIDEO_RESOLUTIONS",function(){return O}),t(e.exports,"SITE_ACTIVITY_EVENT_URL",function(){return S}),t(e.exports,"PAGE_VISIT_EVENT_URL",function(){return v}),t(e.exports,"NODE_ENV",function(){return $});const o="https://d39ynn9qmq2swd.cloudfront.net/public/published",i="https://tolstoyprojects221542-prod.s3.amazonaws.com/public/published",n="https://api.gotolstoy.com",c="https://apilb.gotolstoy.com",s="https://cf-apilb.gotolstoy.com",u="https://fyhmdsxdn7.execute-api.us-east-1.amazonaws.com/rule-groups/get",l="https://player.gotolstoy.com",T="https://play.gotolstoy.com/widget-v2/index.onyou-fullscreen.html",_="https://play.gotolstoy.com/hero",d="widget.gotolstoy.com",I="https://videos.gotolstoy.com",O="https://api.gotolstoy.com/migrations/recreate-video",S="https://analytics-v2.gotolstoy.com/site-activity",v="https://analytics-v2.gotolstoy.com/page-visit",$="production";var C={CONFIG_URL_CDN:o,CONFIG_URL:i,API_BASE_URL:n,API_LB_BASE_URL:c,API_LB_CDN_BASE_URL:s,GET_RULE_GROUPS_URL:u,PLAYER_URL:l,ON_YOU_URL:T,WIDGET_DOMAIN:d,VIDEO_OUTPUT:I,CREATE_VIDEO_RESOLUTIONS:O,SITE_ACTIVITY_EVENT_URL:S,PAGE_VISIT_EVENT_URL:v,NODE_ENV:$}}),y("hlJEM",function(e,a){t(e.exports,"TOLSTOY_CACHE_KEYS",function(){return o}),t(e.exports,"COOKIE_POLICIES",function(){return i});const o={TOLSTOY_HIDE_WIDGET_STORAGE_KEY:"tolstoy-hide-widget",TOLSTOY_SESSION_ID_KEY:"tolstoy-session-id",TOLSTOY_SESSION_UNIQUE_ID_KEY:"tolstoy-session-unique-id",TOLSTOY_PRODUCT_RECOMMENDATIONS:"tolstoy-product-recommendation",TOLSTOY_ANONYMOUS_ID:"tolstoy-anonymousId",TOLSTOY_REPLY:"tolstoy-reply",TOLSTOY_GROUP:"tolstoy-group",TOLSTOY_PUBLISH_ID:"tolstoy-publishId",TOLSTOY_ACTIVITY_KEY:"tolstoy-activity",TOLSTOY_NOT_VISIBLE_OPENED_PUBLISH_ID_KEY:"tolstoy-not-visible-opened-publish-id",TOLSTOY_INTERACTION_DATE:"tolstoy-interaction-date",IS_SHOPIFY_CART_ANONYMOUS_ID_SET_KEY:"tolstoy-is-shopify-cart-anonymous-id-set",TOLSTOY_COOKIE_POLICY:"tolstoy-cookie-policy",TOLSTOY_RECREATE_RESOLUTIONS_PREFIX:"tolstoy-recreate-resolutions",TOLSTOY_AB_TEST_GROUP:"tolstoy-ab-test-group"},i={accepted:"accepted",rejected:"rejected"}}),y("lxjfR",function(e,a){t(e.exports,"uuidv4",function(){return c}),t(e.exports,"getFromSessionStorage",function(){return u}),t(e.exports,"getFromLocalStorage",function(){return l}),t(e.exports,"getFromCache",function(){return _}),t(e.exports,"setToSessionStorage",function(){return d}),t(e.exports,"getCookiePolicy",function(){return $}),t(e.exports,"setLocalStorage",function(){return I}),t(e.exports,"setToCache",function(){return O}),t(e.exports,"removeFromSessionStorage",function(){return S}),t(e.exports,"removeFromCache",function(){return v}),t(e.exports,"setCookiePolicy",function(){return x}),t(e.exports,"setCookie",function(){return C}),t(e.exports,"removeAllTolstoyKeysFromStorage",function(){return Y});var o=r("hlJEM"),i=r("fvcet");const{TOLSTOY_COOKIE_POLICY:n}=o.TOLSTOY_CACHE_KEYS;function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(E){const b=Math.trunc(Math.random()*16);return(E==="x"?b:b&3|8).toString(16)})}function s(E){try{return E()}catch(b){return window.tolstoyCaptureError?.(b),null}}function u(E){return s(()=>window.sessionStorage.getItem(E))}function l(E){return s(()=>localStorage.getItem(E))||u(E)}function T(E){return s(()=>{const b=document.cookie.split("; ").find(N=>N.startsWith(`${E}=`));return b?decodeURIComponent(b.split("=")[1]):null})}function _(E){return l(E)||u(E)||T(E)}function d(E,b,N=!1){s(()=>{if(!($()===o.COOKIE_POLICIES.rejected&&!N))return window.sessionStorage.setItem(E,b)})}function I(E,b,N=!1){s(()=>{if($()!==o.COOKIE_POLICIES.rejected)return localStorage.setItem(E,b);if(N)return window.sessionStorage.setItem(E,b)})}function O(E,b,N=!1){s(()=>{if($()!==o.COOKIE_POLICIES.rejected)return localStorage.setItem(E,b);if(N)return window.sessionStorage.setItem(E,b)})}function S(E){return s(()=>window.sessionStorage.removeItem(E))}function v(E){return s(()=>{window.localStorage.removeItem(E),window.sessionStorage.removeItem(E),U(E)})}const $=()=>_(n),x=E=>{O(n,E,!0)},C=(E,b,N)=>{const B=window.location.host,m=N?`max-age=${N}; `:"",H=`${E}=${encodeURIComponent(b)}; path=/; ${m}Secure; SameSite=None; `;document.cookie=H+`domain=.${B}; `},U=E=>{const b=window.location.host;document.cookie=`${E}=; path=/; domain=.${b}; expires=Thu, 01 Jan 1970 00:00:00 UTC;`,document.cookie=`${E}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;`},P=E=>[...Object.values(o.TOLSTOY_CACHE_KEYS),...Object.values(i.Keys)].some(N=>E.includes(N));function Y(){const E=document.cookie.split("; ");for(const b of E){const[N]=b.split("=");P(N.trim())&&U(N)}for(const b in localStorage)P(b)&&localStorage.removeItem(b);for(const b in sessionStorage)P(b)&&sessionStorage.removeItem(b)}(()=>{const E=document.cookie.split("; ");for(const b of E){const[N]=b.split("=");P(N.trim())&&U(N)}})()}),y("fvcet",function(e,a){t(e.exports,"Keys",function(){return o}),t(e.exports,"COOKIE_KEYS",function(){return i});const o={IDENTIFY_INFO_ID_KEY:"identifyInfoId",SESSION_COUNTER_KEY:"tolstoySessionCounter",LAST_SEEN_AT_KEY:"tolstoyLastSeenAtKey",FIRST_SEEN_AT_KEY:"tolstoyFirstSeenAtKey",TOLSTOY_VIEWERS_KEY:"tolstoyViewers",TOLSTOY_VIEWED_PRODUCTS:"tolstoyViewedProducts",CURRENT_CUSTOMER_EMAIL_KEY:"tolstoyCurrentCustomer",BUBBLE_TEXT_PREFIX:"bubbleText",NOTIFICATION_BADGE_PREFIX:"notificationBadge",RECREATE_NEW_RESOLUTION_PREFIX:"reCreateNewResolution"},i={TOLSTOY_INTERACTION:"_td_key_c",TOLSTOY_IS_ADDED_FROM_TOLSTOY_VARIANT_IDS:"_td_v_id"}}),y("dNsZ9",function(e,a){t(e.exports,"validateUUID",function(){return o});const o=i=>{const n=/^[\da-f]{8}-[\da-f]{4}-[0-5][\da-f]{3}-[089ab][\da-f]{3}-[\da-f]{12}$/i;return i?.match(n)}}),y("tZRsn",function(e,a){t(e.exports,"getIsActiveWidgetEvent",function(){return i}),t(e.exports,"getIsInactiveWidgetEvent",function(){return n});var o=r("8ptJJ");const i=c=>o.ACTIVE_WIDGET_MESSAGES_EVENTS.includes(c),n=c=>o.INACTIVE_WIDGET_MESSAGES_EVENTS.includes(c)}),y("i1NbZ",function(e,a){t(e.exports,"getParameterFromWidgetScripts",function(){return s}),t(e.exports,"getEmbedProductId",function(){return u}),t(e.exports,"getCurrentPageProductId",function(){return l}),t(e.exports,"getShouldUseCache",function(){return T}),t(e.exports,"getCacheVersion",function(){return _});var o=r("kCbDV"),i=r("2Aomz");const n=(d,I)=>{const O=d.src;return new URL(O).searchParams.get(I)},c=(d,I)=>d.getAttribute(`data-${I}`),s=d=>{const I=document.querySelectorAll(`script[src*="${i.WIDGET_DOMAIN}"]`);for(const O of I){const S=c(O,d)||n(O,d);if(S)return S}},u=d=>{const I=d?.dataset?.productId;return I==="{{ product.id }}"?null:I},l=()=>{const d=s(o.WIDGET_SCRIPT_PARAMETERS.productId);if(d)return d;const{stories:I,carousel:O,embed:S,tile:v}=o.EMBED_WIDGETS_CLASSNAMES,$=document.querySelectorAll(`.${I}, .${O}, .${S}, .${v}`);for(const x of $){const C=u(x);if(C)return C}},T=()=>{const d=s(o.WIDGET_SCRIPT_PARAMETERS.shouldUseCache),I=s(o.WIDGET_SCRIPT_PARAMETERS.shop);return d==="true"&&!(I==="rubkik.myshopify.com"||I==="rubkik-dev.myshopify.com")},_=()=>s(o.WIDGET_SCRIPT_PARAMETERS.cacheVersion)}),y("kK0IS",function(e,a){t(e.exports,"getAccountSettings",function(){return _}),t(e.exports,"getWidgetConfigV2",function(){return d}),t(e.exports,"postUserIdentification",function(){return I}),t(e.exports,"getProjectConfig",function(){return O}),t(e.exports,"getConfigByUrl",function(){return S}),t(e.exports,"getConfigByProductId",function(){return v}),t(e.exports,"getCollectionTileConfigs",function(){return $}),t(e.exports,"getBubbleSettings",function(){return x}),t(e.exports,"getCollectionPageTileConfig",function(){return C}),t(e.exports,"sendEvent",function(){return U}),t(e.exports,"createPlayerEvent",function(){return P}),t(e.exports,"createResolutions",function(){return Y}),t(e.exports,"createSiteActivityEvent",function(){return N}),t(e.exports,"createPageVisitEvent",function(){return B});var o=r("2Aomz"),i=r("i1NbZ"),n=r("lUrCX"),c=r("93NPo"),s=r("6QfcD"),u=r("gxrY5"),l=r("izL3O");const T=()=>window.tolstoySettings?.shouldUseCache?o.API_LB_CDN_BASE_URL:o.API_LB_BASE_URL,_=async()=>{const m=(0,s.getAppKey)(),L=(0,l.getShop)()||window.Shopify?.shop,D=(0,i.getShouldUseCache)(),H=(0,i.getCacheVersion)(),j=D?o.API_LB_CDN_BASE_URL:o.API_LB_BASE_URL;let h,A;window.widget_V1_AccountSettingsPromise=new Promise((p,g)=>{h=p,A=g});try{const p=new URL(`${j}/widgets/global-config/getWidgetGlobalConfig`);p.searchParams.set("appKey",m),H&&p.searchParams.set("v",H),L&&p.searchParams.set("appUrl",L);const w=await(await fetch(p.toString())).json();return h(w),w}catch(p){A(p),window.tolstoyCaptureError?.(p,"Error loading account settings:")}},d=async({publishId:m})=>{const L=(0,s.getAppKey)(),D=(0,i.getCacheVersion)(),j=(0,i.getShouldUseCache)()?o.API_LB_CDN_BASE_URL:o.API_LB_BASE_URL;let h,A;window.widget_V1_WidgetConfigV2Promist=new Promise((p,g)=>{h=p,A=g});try{const p=new URL(`${j}/widgets/global-config/getWidgetConfig`);D&&p.searchParams.set("v",D),L&&p.searchParams.set("appKey",L),m&&p.searchParams.set("publishId",m);const w=await(await fetch(p.toString())).json();return window.tolstoyAppKey&&window.tolstoyAppKey.length>0&&w.appKey&&w.appKey.length>0&&w.appKey!==window.tolstoyAppKey?null:(h(w),w)}catch(p){A(p),window.tolstoyCaptureError?.(p,"Error loading config:")}},I=async m=>{try{return(0,c.verifyUserConsent)()?(await fetch(`${o.API_BASE_URL}/identify/identify`,{method:"POST",body:JSON.stringify({data:m})})).json():void 0}catch(L){window.tolstoyCaptureError?.(L,"Error updating identification:")}},O=async(m,L)=>{const D=(0,i.getCurrentPageProductId)(),H=T(),j=(0,i.getCacheVersion)(),h=(0,n.getFilteredSearchParams)({widgetType:L,productId:D,publishId:m,v:j});try{const p=await(await fetch(`${H}/settings/widget/by-publish-id?${h}`)).json();return window.tolstoyAppKey&&window.tolstoyAppKey.length>0&&p.appKey&&p.appKey.length>0&&p.appKey!==window.tolstoyAppKey?null:p}catch(A){window.tolstoyCaptureError?.(A,"Error loading config:")}},S=async m=>{const L=T(),D=(0,i.getCacheVersion)(),H=(0,n.getFilteredSearchParams)({...m,url:`${window.location.origin}${window.location.pathname}`,v:D});try{return(await fetch(`${L}/settings/widget/by-product-url?${H}`)).json()}catch(j){window.tolstoyCaptureError?.(j,"Error getting product page config:")}},v=async m=>{const L=T(),D=(0,i.getCacheVersion)(),H=(0,n.getFilteredSearchParams)({...m,v:D});try{return(await fetch(`${L}/settings/widget/by-product-id?${H}`)).json()}catch(j){window.tolstoyCaptureError?.(j,"Error getting product page config:")}},$=async(m,L)=>{const D=T(),H=(0,i.getCacheVersion)(),j=(0,n.getFilteredSearchParams)({appKey:m,collectionId:L,v:H});try{const A=await(await fetch(`${D}/settings/widget/get-collection-tile-config?${j}`)).json();if(Array.isArray(A)&&A.some(p=>p.project&&p.collectionId)){const p=(0,l.getShop)()||window.Shopify?.shop;return A.filter(g=>g.project.appUrl===p)}}catch(h){window.tolstoyCaptureError?.(h,"Error getting collection tile config:")}return[]},x=async m=>{const L=new URLSearchParams(m);try{return(await fetch(`${o.API_LB_BASE_URL}/settings/bubble?${L.toString()}`)).json()}catch(D){window.tolstoyCaptureError?.(D,"Error getting bubble settings:")}},C=async(m,L)=>{const D=T(),H=(0,i.getCacheVersion)(),j=(0,n.getFilteredSearchParams)({publishId:m,collectionId:L,v:H});try{return(await fetch(`${D}/settings/collection-page-tile-config?${j}`)).json()}catch(h){window.tolstoyCaptureError?.(h,"Error getting collection page tile config:")}},U=async m=>{if(window.location.origin!==void 0&&(0,c.verifyUserConsent)())try{return await fetch(`${o.API_BASE_URL}/events/event`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(m)})}catch(L){window.tolstoyCaptureError?.(L,"Error sending page view:")}},P=(0,u.sendWithInitialDelay)(U),Y=async m=>{try{return await fetch(`${o.CREATE_VIDEO_RESOLUTIONS}?publishId=${m}`)}catch(L){window.tolstoyCaptureError?.(L)}},R=!0,E=!0,b=m=>{const L=m?.siteActivity;return!L||L===""||Object.keys(L).length===0?!1:Object.values(L).some(D=>D?.totalTime>0)},N=(0,u.sendWithInitialDelay)(m=>{if(!(R&&!b(m))&&(0,c.verifyUserConsent)())try{window.navigator.sendBeacon(o.SITE_ACTIVITY_EVENT_URL,JSON.stringify(m))}catch(L){const D="Error occurred in createSiteActivityEvent";console.error(D,L),window.tolstoyCaptureError?.(L,D)}}),B=(0,u.sendWithInitialDelay)(m=>{if(!E&&(0,c.verifyUserConsent)())try{window.navigator.sendBeacon(o.PAGE_VISIT_EVENT_URL,JSON.stringify(m))}catch(L){const D="Error occurred in createPageVisitEvent";console.error(D,L),window.tolstoyCaptureError?.(L,D)}})}),y("lUrCX",function(e,a){t(e.exports,"getIsTheSameURL",function(){return s}),t(e.exports,"getUrlCustomParams",function(){return u}),t(e.exports,"getFilteredSearchParams",function(){return l}),t(e.exports,"isUrl",function(){return T}),t(e.exports,"getIsEmailCampaignProject",function(){return _});const o="www.",i=new RegExp("^((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)","i"),n=d=>d?!!i.test(d)||d.startsWith("tel:")||d.startsWith("mailto:")||d.startsWith("_self:"):!1,c=d=>{const I=d.replace(o,""),O=new URL(I);return`${O.origin}${O.pathname}${O.search}`},s=(d,I)=>!n(d)||!n(I)?!1:c(d)===c(I),u=()=>{const d=new URLSearchParams(window.location.search),I=new URLSearchParams;for(const[O,S]of d){const v=O.toLowerCase();O.length<50&&S.length<100&&(v.startsWith("custom_")||v.startsWith("utm_"))&&I.append(O,S)}return I},l=(d={})=>{const I=new URLSearchParams;for(const[O,S]of Object.entries(d))S!=null&&S!==""&&I.append(O,S);return I.toString()},T=d=>i.test(d),_=d=>new URLSearchParams(window.location.search).get("tolstoy")===d}),y("6QfcD",function(e,a){t(e.exports,"getAppKey",function(){return c});var o=r("kCbDV"),i=r("i1NbZ");let n="";function c(){return window.tolstoyAppKey||n?window.tolstoyAppKey||n:(n=(0,i.getParameterFromWidgetScripts)(o.WIDGET_SCRIPT_PARAMETERS.appKey),n)}}),y("gxrY5",function(e,a){t(e.exports,"sendWithInitialDelay",function(){return s});const o=4e3;let i=!1;const n=[],c=()=>{for(;n.length>0;){const{eventFunction:u,args:l}=n.shift();u(...l)}};setTimeout(()=>{i=!0,c()},o);const s=u=>(...l)=>{if(i)return u(...l);n.push({eventFunction:u,args:l})}}),y("izL3O",function(e,a){t(e.exports,"getShop",function(){return n});var o=r("kCbDV"),i=r("i1NbZ");function n(){return(0,i.getParameterFromWidgetScripts)(o.WIDGET_SCRIPT_PARAMETERS.shop)||window.Shopify?.shop||""}}),y("eSOI5",function(e,a){t(e.exports,"getAndSetAnonymousId",function(){return b}),t(e.exports,"setPublishId",function(){return L}),t(e.exports,"getTolstoysActivity",function(){return D}),t(e.exports,"pushTolstoyActivity",function(){return H}),t(e.exports,"pushTolstoyViewedProducts",function(){return j}),t(e.exports,"clearTolstoyActivity",function(){return h}),t(e.exports,"setIsReply",function(){return p}),t(e.exports,"setTolstoyProductRecommendation",function(){return g}),t(e.exports,"getTolstoyViewers",function(){return V}),t(e.exports,"setTolstoyViewers",function(){return Z}),t(e.exports,"getTolstoyInteractionDate",function(){return F}),t(e.exports,"setIdentifyInfoId",function(){return ce}),t(e.exports,"getIdentifyInfoId",function(){return tt}),t(e.exports,"removeIdentifyInfoId",function(){return ot}),t(e.exports,"setSessionCounter",function(){return rt}),t(e.exports,"getSessionCounter",function(){return nt}),t(e.exports,"setFirstSeenAt",function(){return st}),t(e.exports,"getFirstSeenAt",function(){return at}),t(e.exports,"setTolstoyInteractionDate",function(){return ct}),t(e.exports,"updateIsAddedFromTolstoyVariantIds",function(){return lt}),t(e.exports,"getTolstoyHideWidget",function(){return ut}),t(e.exports,"setTolstoyHideWidget",function(){return ft}),t(e.exports,"removeTolstoyHideWidget",function(){return pt}),t(e.exports,"getSessionId",function(){return $t}),t(e.exports,"setSessionId",function(){return Et}),t(e.exports,"removeSessionId",function(){return bt}),t(e.exports,"getSessionUniqueId",function(){return St}),t(e.exports,"getNotVisibleOpenedTolstoyPublishId",function(){return yt}),t(e.exports,"setNotVisibileOpenedTolstoyPublishId",function(){return _t}),t(e.exports,"updateTolstoyActivitySessionIdByPublishId",function(){return gt}),t(e.exports,"getIsShopifyCartAnonymousIdSet",function(){return It}),t(e.exports,"setIsShopifyCartAnonymousIdSet",function(){return xt}),t(e.exports,"setTolstoyRecreateResolution",function(){return vt}),t(e.exports,"getTolstoyRecreateResolution",function(){return ht}),t(e.exports,"setShowNotificationBadge",function(){return Nt}),t(e.exports,"getShowNotificationBadge",function(){return At}),t(e.exports,"setShowBubbleText",function(){return Ot}),t(e.exports,"getShowBubbleText",function(){return Ct}),t(e.exports,"setRecreateNewResolution",function(){return Rt}),t(e.exports,"getRecreateNewResolution",function(){return Lt}),t(e.exports,"setAbTestGroup",function(){return wt}),t(e.exports,"getAbTestGroup",function(){return Pt});var o=r("lY4N9"),i=r("hlJEM"),n=r("lxjfR"),c=r("fvcet");const{TOLSTOY_HIDE_WIDGET_STORAGE_KEY:s,TOLSTOY_SESSION_ID_KEY:u,TOLSTOY_SESSION_UNIQUE_ID_KEY:l,TOLSTOY_PRODUCT_RECOMMENDATIONS:T,TOLSTOY_ANONYMOUS_ID:_,TOLSTOY_REPLY:d,TOLSTOY_GROUP:I,TOLSTOY_PUBLISH_ID:O,TOLSTOY_ACTIVITY_KEY:S,TOLSTOY_NOT_VISIBLE_OPENED_PUBLISH_ID_KEY:v,TOLSTOY_INTERACTION_DATE:$,IS_SHOPIFY_CART_ANONYMOUS_ID_SET_KEY:x,TOLSTOY_RECREATE_RESOLUTIONS_PREFIX:C,TOLSTOY_AB_TEST_GROUP:U}=i.TOLSTOY_CACHE_KEYS,P=2592e3;function Y(f){return f?`${$}-${f}`:$}function R(){return(0,n.getFromCache)(_)}function E(f){!f||["undefined","false"].includes(f)||(0,n.setToCache)(_,f)}function b(){let M=((0,o.getIsTapcart)()?(0,o.getTapcartDeviceId)():null)||R()||(0,n.uuidv4)();return M==="false"&&(M=(0,n.uuidv4)()),E(M),M}function N(){return(0,n.getFromCache)(I)}function B(f){(0,n.setToCache)(I,f,!0)}function m(){return(0,n.getFromCache)(O)}function L(f){(0,n.setToCache)(O,f,!0)}function D(){return JSON.parse((0,n.getFromSessionStorage)(S)||"{}")}function H({publishId:f,timeStamp:M,type:G,sessionId:J}){const q=D()||{},mt=q[f]||[];q[f]=[...mt,{timeStamp:M,type:G,sessionId:J}],(0,n.setToSessionStorage)(S,JSON.stringify(q),!0)}const j=({publishId:f,productId:M})=>{const G=z(),J=G[M]||[],q={interactionDate:new Date().toISOString(),publishId:f,productId:M};J.push(q),G[M]=J,Q(G)},h=()=>{(0,n.setToSessionStorage)(S,"{}",!0)};function A(){return(0,n.getFromCache)(d)}function p(f){(0,n.setToCache)(d,f)}function g(){(0,n.setToCache)(T,!0)}function w(){return(0,n.getFromCache)(T)}const V=()=>JSON.parse((0,n.getFromLocalStorage)(c.Keys.TOLSTOY_VIEWERS_KEY)||"{}"),k=()=>V().abTest||{},K=f=>{const M=V();M.abTest=f,Z(M)},z=()=>JSON.parse((0,n.getFromCache)(c.Keys.TOLSTOY_VIEWED_PRODUCTS)||"{}"),Q=f=>{(0,n.setToCache)(c.Keys.TOLSTOY_VIEWED_PRODUCTS,JSON.stringify(f))},Z=f=>{(0,n.setLocalStorage)(c.Keys.TOLSTOY_VIEWERS_KEY,JSON.stringify(f))};function F(f){return(0,n.getFromCache)(Y(f))||(0,n.getFromCache)(Y())}function ce(f){(0,n.setLocalStorage)(c.Keys.IDENTIFY_INFO_ID_KEY,f)}function tt(){return(0,n.getFromLocalStorage)(c.Keys.IDENTIFY_INFO_ID_KEY)}function ot(){localStorage.removeItem(c.Keys.IDENTIFY_INFO_ID_KEY)}const rt=f=>{(0,n.setLocalStorage)(c.Keys.SESSION_COUNTER_KEY,f)},nt=()=>Number((0,n.getFromLocalStorage)(c.Keys.SESSION_COUNTER_KEY)),st=f=>{(0,n.setLocalStorage)(c.Keys.FIRST_SEEN_AT_KEY,f)},at=()=>(0,n.getFromLocalStorage)(c.Keys.FIRST_SEEN_AT_KEY);function ct(f,M){const G=new Date().toISOString();(0,n.setToCache)(Y(f),G),it(M)}const it=f=>{(0,n.setCookie)(c.COOKIE_KEYS.TOLSTOY_INTERACTION,JSON.stringify({anonymousId:b(),appUrl:f}),P),(0,n.setLocalStorage)(c.COOKIE_KEYS.TOLSTOY_INTERACTION,JSON.stringify({anonymousId:b(),appUrl:f}),!0)},Ut=()=>{const f=(0,n.getFromCache)(c.COOKIE_KEYS.TOLSTOY_INTERACTION);return JSON.parse(f||"{}")},dt=()=>{const f=(0,n.getFromCache)(c.Keys.TOLSTOY_IS_ADDED_FROM_TOLSTOY_VARIANT_IDS);return JSON.parse(f||"[]")},lt=f=>{try{const M=dt();M.includes(f)||M.push(`${f}`),(0,n.setLocalStorage)(c.COOKIE_KEYS.TOLSTOY_IS_ADDED_FROM_TOLSTOY_VARIANT_IDS,JSON.stringify(M),!0),(0,n.setCookie)(c.COOKIE_KEYS.TOLSTOY_IS_ADDED_FROM_TOLSTOY_VARIANT_IDS,JSON.stringify(M),P)}catch{}},ut=f=>(0,n.getFromSessionStorage)(`${s}-${f}`),ft=f=>(0,n.setToSessionStorage)(`${s}-${f}`,"true",!0),pt=f=>window.sessionStorage.removeItem(`${s}-${f}`),$t=()=>(0,n.getFromSessionStorage)(u),Et=f=>(0,n.setToSessionStorage)(u,f,!0),bt=()=>(0,n.removeFromSessionStorage)(u),St=()=>{const f=(0,n.getFromSessionStorage)(l);return f||Tt()},Tt=()=>{const f=(0,n.uuidv4)();return(0,n.setToSessionStorage)(l,f,!0),f},yt=()=>{const f=(0,n.getFromSessionStorage)(v);return!f||f==="null"?null:f},_t=f=>(0,n.setToSessionStorage)(v,f,!0),gt=(f,M)=>{const G=D()||{},J=G[f]||[];if(!J?.length)return;const q=J[J.length-1];q.sessionId=M,(0,n.setToSessionStorage)(S,JSON.stringify(G),!0)},It=()=>(0,n.getFromSessionStorage)(x),xt=f=>(0,n.setToSessionStorage)(x,f),vt=f=>(0,n.setLocalStorage)(`${C}-${f}`,"true",!0),ht=f=>(0,n.getFromLocalStorage)(`${C}-${f}`),Nt=(f,M)=>(0,n.setLocalStorage)(`${c.Keys.NOTIFICATION_BADGE_PREFIX}-${f}`,M,!0),At=f=>(0,n.getFromLocalStorage)(`${c.Keys.NOTIFICATION_BADGE_PREFIX}-${f}`),Ot=(f,M,G)=>(0,n.setLocalStorage)(`${c.Keys.BUBBLE_TEXT_PREFIX}-${f}-${M}`,G,!0),Ct=(f,M)=>(0,n.getFromLocalStorage)(`${c.Keys.BUBBLE_TEXT_PREFIX}-${f}-${M}`),Rt=(f,M)=>(0,n.setLocalStorage)(`${c.Keys.RECREATE_NEW_RESOLUTION_PREFIX}-${f}`,M,!0),Lt=f=>(0,n.getFromLocalStorage)(`${c.Keys.RECREATE_NEW_RESOLUTION_PREFIX}-${f}`),wt=(f,M)=>(0,n.setLocalStorage)(`${U}-${f}`,M,!0),Pt=f=>(0,n.getFromLocalStorage)(`${U}-${f}`)}),y("lY4N9",function(e,a){t(e.exports,"getIsTapcart",function(){return i}),t(e.exports,"getTapcartDeviceId",function(){return n}),t(e.exports,"isTapcartDashboard",function(){return c});const o="custom-blocks.tapcart.com",i=()=>!!(window?.Tapcart?.isInitialized||document.location?.host?.includes(o)),n=()=>window?.Tapcart?.variables?.device?.id?.toLowerCase(),c=()=>window?.location?.hostname?.includes&&window.location.hostname.includes("app.tapcart.com")}),y("xb7kn",function(e,a){t(e.exports,"tolstoyWidgetReady",function(){return i}),t(e.exports,"tolstoyPlayerReady",function(){return n});var o=r("8ptJJ");const i=()=>{const c=new CustomEvent("tolstoyWidgetReady");window.dispatchEvent(c)},n=()=>{const c=new CustomEvent(o.TOLSTOY_PLAYER_READY_MESSAGE);window.dispatchEvent(c)}}),y("aEodP",function(e,a){t(e.exports,"INTERNAL_EVENTS",function(){return x});const x={...{modalOpen:"tolstoyModalOpen",playerReady:"tolstoyPlayerReady",toggleFeedCloseButton:"toggleFeedCloseButton",showFeedProductModal:"showFeedProductModal",reportModalOpen:"tolstoyReportModalOpen",reportModalClose:"tolstoyReportModalClose",modalMessagingReady:"tolstoyModalMessagingReady",closePlayer:"tolstoyClosePlayer",userEmailUpdate:"tolstoyUserEmailUpdate"},...{isRebuyAppInstalled:"tolstoyIsRebuyAppInstalled",openRebuyCart:"tolstoyOpenRebuyCart",rebuyCartShown:"rebuyCartShown",rebuyCartHidden:"rebuyCartHidden"},...{openKendoModal:"tolstoyOpenKendoModal",changeZIndex:"tolstoyChangeZIndex"},...{isAfterpayAppInstalled:"tolstoyIsAfterpayAppInstalled"},...{getProductsMetafields:"getProductsMetafields",returnProductsMetafields:"returnProductsMetafields"},...{productCardClick:"tolstoyProductCardClick"},...{spotlightCarouselQuickShopClick:"tolstoySpotlightCarouselQuickShopClick"},...{externalEventSubscribed:"tolstoyExternalEventSubscribed",productCardClickSubscribed:"tolstoyProductCardClickSubscribed"},...{isTapcart:"tolstoyIsTapcart",openTapcartProduct:"tolstoyOpenTapcartProduct"},...{setAnonymousIdToCart:"tolstoySetAnonymousIdToCart",blockAnonymousIdToCart:"tolstoyBlockAnonymousIdToCart",addToCart:"tolstoyAddToCart",addToCartSuccess:"tolstoyAddToCartSuccess",addToCartError:"tolstoyAddToCartError",addToCartSoldOut:"tolstoyAddToCartSoldOut",addToCartDisableDefault:"tolstoyAddToCartDisableDefault",cartItemQuantityChange:"tolstoyCartItemQuantityChange",cartItemQuantityChangeSuccess:"tolstoyCartItemQuantityChangeSuccess",cartItemQuantityChangeError:"tolstoyCartItemQuantityChangeError",cartDataRequest:"tolstoyCartDataRequest",cartDataResponse:"tolstoyCartDataResponse"},...{loginWithMultipassUrlRequest:"tolstoyLoginWithMultipassUrl",loginWithMultipassUrlResponse:"tolstoyLoginWithMultipassUrlResponseMessage"},...{productRecommendationsRequest:"tolstoyProductRecommendationsRequest",productRecommendationsResponse:"tolstoyProductRecommendationsResponse"},...{requestProductsUpdate:"tolstoyRequestProductsUpdate",productUpdateResponse:"tolstoyProductUpdateResponse",moveToUrl:"tolstoyMoveToUrl",isNonBaseCurrency:"tolstoyIsNonBaseCurrency"},...{urlChange:"urlChange",urlLocaleUpdate:"tolstoyUrlLocaleUpdate"},...{openCommerceSettingsUpdate:"tolstoyOpenCommerceSettingsUpdate"},acceptCookiePolicy:"acceptCookiePolicy",rejectCookiePolicy:"rejectCookiePolicy"}}),y("519R9",function(e,a){t(e.exports,"default",function(){return s});var o=r("dEa8z"),i=r("93NPo");class n extends o.default{constructor(){if(n.instance)return n.instance;super({shouldArchivePastEvents:!0}),n.instance=this}eventHandler=l=>{const{data:T={}}=l,{eventName:_}=T;if(this.eventCallbacks[_])for(const d of this.eventCallbacks[_])d(l)};postMessage=l=>{const T=l.transmissionId||(0,i.generateUUID)();return super.postMessage({...l,transmissionId:T}),T};init=()=>{this.initListener(this.eventHandler)}}const c=new n;Object.freeze(c);var s=c}),y("dEa8z",function(e,a){t(e.exports,"default",function(){return n});var o=r("lqvQ6");class i{constructor({shouldIncludeLogs:s=!1,shouldArchivePastEvents:u=!1}={}){this.broadcastHub=new o.default,this.eventCallbacks={},this.pastEvents={},this.shouldIncludeLogs=s,this.shouldArchivePastEvents=u}logMessage(s){this.shouldIncludeLogs&&console.log(s)}throwError(s){if(this.shouldIncludeLogs)throw new Error(s)}archivePastEvent(s){if(!this.shouldArchivePastEvents)return;const{eventName:u}=s;this.pastEvents[u]||(this.pastEvents[u]=[]),this.pastEvents[u].push(s)}postMessage(s){this.archivePastEvent(s),this.broadcastHub.postMessage(s)}postPastEvents({eventName:s,callback:u}){if(this.pastEvents[s])for(const l of this.pastEvents[s])u({data:{...l,isPastEvent:!0}})}subscribe({eventName:s,callback:u,shouldIncludePastEvents:l}){if(this.eventCallbacks[s]||(this.eventCallbacks[s]=new Set),this.eventCallbacks[s].has(u)){this.throwError(`Already subscribed to event ${s} with this callback`);return}this.eventCallbacks[s].add(u),l&&this.postPastEvents({eventName:s,callback:u})}subscribeMultipleEvents=({eventNames:s,callback:u,shouldIncludePastEvents:l})=>{for(const T of s)this.subscribe({eventName:T,callback:u,shouldIncludePastEvents:l})};unsubscribe({eventName:s,callback:u}){if(!this.eventCallbacks[s]){this.throwError(`Not subscribed to event ${s}`);return}if(!this.eventCallbacks[s].has(u)){this.throwError("Callback is not subscribed");return}if(!this.eventCallbacks[s].delete(u)){this.logMessage(`Not subscribed to event ${s} with this callback`);return}this.logMessage(`Unsubscribed from event ${s}`)}unsubscribeMultipleEvents=({eventNames:s,callback:u})=>{for(const l of s)this.unsubscribe({eventName:l,callback:u})};initListener(s){this.broadcastHub.addEventListener("message",s)}}var n=i}),y("lqvQ6",function(e,a){t(e.exports,"default",function(){return n});var o=r("93NPo");class i{constructor(s){this.name=s||(0,o.generateUUID)();try{"BroadcastChannel"in self&&(this.broadcaster=new BroadcastChannel(this.name),this.receiver=new BroadcastChannel(this.name))}catch(u){console.error("self is not defined",u)}}postMessage=s=>{this.broadcaster?.postMessage(s)};addEventListener=(...s)=>{this.receiver?.addEventListener(...s)}}var n=i}),y("ljwIw",function(e,a){t(e.exports,"createElement",function(){return o}),t(e.exports,"createScript",function(){return i}),t(e.exports,"createIframe",function(){return n}),t(e.exports,"registerDomUpdatesListener",function(){return u}),t(e.exports,"safePlayVideo",function(){return l}),t(e.exports,"stringToHTML",function(){return T}),t(e.exports,"getPublicId",function(){return _}),t(e.exports,"getElementSelector",function(){return d}),t(e.exports,"getElement",function(){return I}),t(e.exports,"getCustomElementSelector",function(){return S}),t(e.exports,"getCustomElement",function(){return v});const o=({tagName:$,src:x,container:C,attributes:U,style:P,styleString:Y,classNames:R,eventListeners:E})=>{const b=document.createElement($);if(E)for(const[N,B]of Object.entries(E))b.addEventListener(N,B);if(x&&(b.src=x),U)for(const[N,B]of Object.entries(U))b.setAttribute(N,B);if(Y&&(b.style.cssText=Y),P)for(const[N,B]of Object.entries(P))b.style[N]=B;return R&&b.classList.add(...R),C&&C.append(b),b},i=({src:$,container:x,attributes:C})=>o({tagName:"script",src:$,container:x,attributes:C}),n=({src:$,container:x,attributes:C,style:U})=>o({tagName:"iframe",src:$,container:x,attributes:C,style:U}),c=({callback:$,classNames:x})=>{const C=N=>x.some(B=>N.getElementsByClassName(B).length>0),U=N=>x.includes(N),P=N=>[...N.classList].some(U),Y=N=>N.classList?P(N)||C(N):!1,R=N=>N.type!=="childList"||N.addedNodes.length===0?!1:[...N.addedNodes].some(Y),E=N=>{N.some(R)&&$()};new window.MutationObserver(E).observe(document.body,{subtree:!0,childList:!0})},s=({callback:$})=>{window.addEventListener("DOMContentLoaded",$),window.addEventListener("load",$)},u=({callback:$,classNames:x})=>{s({callback:$}),"MutationObserver"in window&&c({callback:$,classNames:x})},l=({video:$,onError:x})=>{if(!$)return Promise.reject(new Error("No video element"));const C=/iPad|iPhone|iPod/.test(navigator.userAgent),U=Number.parseFloat(navigator.userAgent.match(/OS (\d+)_/)?.[1]||"0");return C&&U>=18&&$.readyState<1&&$.load(),$.play().catch(Y=>(console.warn("Video play failed:",Y),x&&x(Y),Promise.reject(Y)))},T=$=>{const x=document.createElement("div");return x.innerHTML=$.trim(),x.firstChild},_=($,x)=>`${$}-${x}`,d=($,x)=>`[data-tolstoy-element="${_($,x)}"]`,I=($,x)=>window.document.querySelector(d($,x)),O=($,x)=>window.document.querySelectorAll(`[data-tolstoy-element="${_($,x)}"]`),S=($,x)=>`[${$}="${x}"]`,v=($,x)=>window.document.querySelector(`[${$}="${x}"]`)}),y("4dQPj",function(e,a){t(e.exports,"default",function(){return I});var o=r("aEodP"),i=r("8ptJJ"),n=r("519R9"),c=r("e3391");const s={},u={},l={},T=[];class _{constructor(){if(_.instance)return _.instance;_.instance=this}registerIframe({modalId:S,modalIframe:v}){s[S]=v}postInternalMessage({modalId:S,data:v}){delete v.modalId;const $=n.default.postMessage(v);l[$]=S}handleModalMessagingReady({modalId:S}){u[S]=!0;const v=s[S];for(const $ of T){const{transmissionId:x}=$,C=l[x];(!C||C===S)&&this.postMessageToIframe({iframe:v,message:$})}}eventHandler=({data:S={}})=>{const{modalId:v,eventName:$}=S;if(v)switch($){case o.INTERNAL_EVENTS.addToCart:case o.INTERNAL_EVENTS.openRebuyCart:case o.INTERNAL_EVENTS.openKendoModal:case o.INTERNAL_EVENTS.getProductsMetafields:case o.INTERNAL_EVENTS.productCardClick:case o.INTERNAL_EVENTS.loginWithMultipassUrlRequest:case o.INTERNAL_EVENTS.cartItemQuantityChange:case o.INTERNAL_EVENTS.cartDataRequest:case o.INTERNAL_EVENTS.productRecommendationsRequest:case o.INTERNAL_EVENTS.requestProductsUpdate:case o.INTERNAL_EVENTS.moveToUrl:case o.INTERNAL_EVENTS.showFeedProductModal:case o.INTERNAL_EVENTS.reportModalOpen:case o.INTERNAL_EVENTS.reportModalClose:case i.TOLSTOY_PLAYER_READY_MESSAGE:return this.postInternalMessage({modalId:v,data:S});case o.INTERNAL_EVENTS.modalMessagingReady:return this.postInternalMessage({modalId:v,data:S}),this.handleModalMessagingReady({modalId:v});case o.INTERNAL_EVENTS.toggleFeedCloseButton:return this.postInternalMessage({modalId:v,data:S});default:return null}};internalEventHandler=({data:S})=>{this.postMessageToModal(S)};postMessageToIframe({iframe:S,message:v}){S.contentWindow?.postMessage(v,"*")}postMessageToAllIframes({message:S}){T.push(S);for(const[v,$]of Object.entries(s))u[v]&&this.postMessageToIframe({iframe:$,message:S})}postMessageToModal(S){const{transmissionId:v,shouldEndTransmission:$=!0,...x}=S,C=l[v];if(!C)return this.postMessageToAllIframes({message:x});if(!u[C]){T.push(S);return}const P=s[C];this.postMessageToIframe({iframe:P,message:x}),$&&delete l[v]}initInternalMessagingSubscriptions=()=>{n.default.subscribeMultipleEvents({eventNames:c.INTERNAL_MESSAGES_TO_SUBSCRIBE,callback:this.internalEventHandler})};init(){this.initInternalMessagingSubscriptions(),window.addEventListener("message",this.eventHandler)}}const d=new _;Object.freeze(d);var I=d}),y("e3391",function(e,a){t(e.exports,"INTERNAL_MESSAGES_TO_SUBSCRIBE",function(){return i});var o=r("aEodP");const i=[o.INTERNAL_EVENTS.addToCartError,o.INTERNAL_EVENTS.addToCartSuccess,o.INTERNAL_EVENTS.addToCartSoldOut,o.INTERNAL_EVENTS.isRebuyAppInstalled,o.INTERNAL_EVENTS.isAfterpayAppInstalled,o.INTERNAL_EVENTS.openRebuyCart,o.INTERNAL_EVENTS.returnProductsMetafields,o.INTERNAL_EVENTS.acceptCookiePolicy,o.INTERNAL_EVENTS.rejectCookiePolicy,o.INTERNAL_EVENTS.productCardClickSubscribed,o.INTERNAL_EVENTS.isTapcart,o.INTERNAL_EVENTS.urlLocaleUpdate,o.INTERNAL_EVENTS.loginWithMultipassUrlResponse,o.INTERNAL_EVENTS.cartDataResponse,o.INTERNAL_EVENTS.cartItemQuantityChangeSuccess,o.INTERNAL_EVENTS.cartItemQuantityChangeError,o.INTERNAL_EVENTS.productRecommendationsResponse,o.INTERNAL_EVENTS.productUpdateResponse,o.INTERNAL_EVENTS.isNonBaseCurrency,o.INTERNAL_EVENTS.eventListenersInitialized]}),y("3ntgJ",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("i8uuP")).then(()=>r("2S3LN"))}),y("1rN27",function(e,a){"use strict";var o=r("JNMYe");e.exports=o(function(i){return new Promise(function(n,c){var s=document.getElementsByTagName("script");if([].concat(s).some(function(T){return T.src===i})){n();return}var u=document.createElement("link");u.href=i,u.rel="preload",u.as="script",document.head.appendChild(u);var l=document.createElement("script");l.async=!0,l.type="text/javascript",l.src=i,l.onerror=function(T){var _=new TypeError("Failed to fetch dynamically imported module: ".concat(i,". Error: ").concat(T.message));l.onerror=l.onload=null,l.remove(),c(_)},l.onload=function(){l.onerror=l.onload=null,n()},document.getElementsByTagName("head")[0].appendChild(l)})})}),y("JNMYe",function(e,a){"use strict";var o={},i={},n={};function c(s){switch(s){case"preload":return i;case"prefetch":return n;default:return o}}e.exports=function(s,u){return function(l){var T=c(u);return T[l]?T[l]:T[l]=s.apply(null,arguments).catch(function(_){throw delete T[l],_})}}}),y("7EyoR",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("aslI4")).then(()=>r("i4yUB"))}),y("20jZi",function(e,a){e.exports=Promise.all([r("1rN27")(r("jHnDr").resolve("i8uuP")),r("1rN27")(r("jHnDr").resolve("bbcX5"))]).then(()=>r("SMK6d"))}),y("9xImz",function(e,a){e.exports=Promise.all([r("1rN27")(r("jHnDr").resolve("6RawR")),r("1rN27")(r("jHnDr").resolve("fWIyY")),r("1rN27")(r("jHnDr").resolve("cYlHC"))]).then(()=>r("dnUNq"))}),y("4xGBK",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("dKxcl")).then(()=>r("g9R7i"))}),y("3CzU6",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("eDAhl")).then(()=>r("dc422"))}),y("kT78r",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("l0JpJ")).then(()=>r("2dXcK"))}),y("j5yXP",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("1DY44")).then(()=>r("4Z19s"))}),y("aeVRw",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("i5ZhA")).then(()=>r("1nS19"))}),y("ceBz0",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("hrz8i")).then(()=>r("l8cxn"))}),y("eEPht",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("iVld5")).then(()=>r("6gZvj"))}),y("9LxpD",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("kOWhD")).then(()=>r("j3Rly"))}),y("8qEs3",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("hmbkR")).then(()=>r("1xZaa"))}),y("eCvYE",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("j48za")).then(()=>r("dwbHY"))}),y("46e13",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("acYDh")).then(()=>r("iq3md"))}),y("20E5q",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("gZRwx")).then(()=>r("klml0"))}),y("bAqc6",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("48rPv")).then(()=>r("bDaQR"))}),y("9fbdk",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("9RihJ")).then(()=>r("kWDbk"))}),y("c2UxD",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("du4Vw")).then(()=>r("eMLZH"))}),y("intUv",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("fWIyY")).then(()=>r("bkGGB"))}),y("hY2Ky",function(e,a){e.exports=Promise.all([r("1rN27")(r("jHnDr").resolve("fWIyY")),r("1rN27")(r("jHnDr").resolve("k2Q5z"))]).then(()=>r("1BUT1"))}),y("aNjZO",function(e,a){e.exports=r("1rN27")(r("jHnDr").resolve("c8ux4")).then(()=>r("bIJgo"))});var Dt={};r("jHnDr").register(r("2372k").getBundleURL("fWNwr"),JSON.parse('["fWNwr","widget.js","i8uuP","embed-widgets.utils.js","aslI4","product-gallery-video-loader.js","bbcX5","embed-widgets.js","7SdT5","collection-tile-init-templates.js","cYlHC","floating-widget-loader.js","aKM9X","centered-modal.js","cDpG9","CenteredModal.a5ba51dc.js","isfCu","CenteredModal.1a8b3526.css","b9uE3","bubble.js","koqqC","Bubble.611faa6d.css","fWIyY","account.js","6RawR","common-loader.js","dKxcl","video-widget-loader.js","dTIhU","t-v.js","3xAff","TV.8d0c699d.css","eDAhl","external-messaging.js","l0JpJ","external-event-subscriber.js","1DY44","shopify-subscriber.js","i5ZhA","url-subscriber.js","hrz8i","custom-cart-subscriber.js","iVld5","rebuy-subscriber.js","kOWhD","kendo-subscriber.js","hmbkR","tapcart-subscriber.js","j48za","afterpay-subscriber.js","acYDh","cookie-policy-subscriber.js","gZRwx","player-events-subscriber.js","48rPv","open-commerce-subscriber.js","9RihJ","product-subscriber.js","du4Vw","widget-v2-subscriber.js","k2Q5z","embed-widgets-loader.js","5tuD6","carousel-loader-v2.js","izN8B","carousel-skeleton.js","1NB7b","CarouselSkeleton.66dafc9f.js","ew0qU","CarouselSkeleton.b837d2e6.css","dj7hR","carousel.js","kFOMR","Carousel.017f4d09.css","hiyMq","spotlight-carousel-v2.js","b34Kc","spotlight-carousel-video-v2.js","9FErS","SpotlightCarouselVideo.26558c47.css","k1vpo","content-tile-v2.js","bS5RJ","ContentTile.63d53731.css","4keBy","spotlight-carousel-arrow-v2.js","hn0L0","SpotlightCarouselArrow.1c040f74.css","6MhzS","spotlight-carousel-tile-v2.js","aN3Ai","SpotlightCarouselTile.1c040f74.css","9NklG","spotlight-carousel-tile-text-v2.js","7JFTj","spotlight-carousel-progress-bar-v2.js","j8tKg","SpotlightCarouselProgressBar.1c040f74.css","2EQBB","spotlight-carousel-controller-v2.js","89rZX","carousel-loader.js","bwTLD","spotlight-carousel.js","lmUHe","spotlight-carousel-video.js","baNop","SpotlightCarouselVideo.b837d2e6.css","3N0NX","content-tile.js","6U3tz","ContentTile.f1dfa512.css","aDwLk","spotlight-carousel-arrow.js","6lus3","SpotlightCarouselArrow.ebdfbd05.css","gkl30","spotlight-carousel-tile.js","dAPEo","SpotlightCarouselTile.ebdfbd05.css","1p0Ow","spotlight-carousel-tile-text.js","9FVlg","spotlight-carousel-progress-bar.js","3usLk","SpotlightCarouselProgressBar.ebdfbd05.css","2SjbV","spotlight-carousel-controller.js","6UW58","story-v2.js","16zx1","Story.c68c3d96.css","34FYC","story.js","ls8QA","Story.27cf7732.css","l1VTG","embed.js","1U8tk","Embed.659a377c.css","jiIH5","tile.js","cGSvp","Tile.864911ff.css","lCIdQ","collection-tile-controller.js","6iLLd","CollectionTileController.821f8f4a.css","6mZ8R","collection-page-tile-controller.js","ksyNr","CollectionPageTileController.104ab420.css","c8ux4","product-metafields-subscriber.js"]'));var te=r("aQK74"),Ee=r("xb7kn"),de=r("2Aomz"),oe=r("lY4N9");const ee={PDP_CAROUSEL:"pdp-carousel",VIDEO_PAGE:"video-page"},W={HEADER:"header",HEADER_AND_BOTTOM_NAVBAR:"header-and-bottom-navbar",CUSTOM_SCREEN:"custom-screen",CUSTOM_SCREEN_AND_BOTTOM_NAVBAR:"custom-screen-and-bottom-navbar"},ne=e=>document.documentElement.style.setProperty("height",`${e}px`,"important"),be=()=>navigator.userAgent.toLowerCase().includes("android"),Se=e=>{const a=window.screen.availHeight,o=window.Tapcart.variables.device.windowHeight;switch(e){case W.HEADER:return o;case W.HEADER_AND_BOTTOM_NAVBAR:return o;case W.CUSTOM_SCREEN:return a-100;case W.CUSTOM_SCREEN_AND_BOTTOM_NAVBAR:return a-184;default:return o||a}},Te=e=>{const a=window.screen.availHeight,o=window.Tapcart.variables.device.windowHeight;switch(e){case W.HEADER:return o;case W.HEADER_AND_BOTTOM_NAVBAR:return o-75;case W.CUSTOM_SCREEN:return a-90;case W.CUSTOM_SCREEN_AND_BOTTOM_NAVBAR:return a-175;default:return o||a}},ye=e=>be()?Se(e):Te(e),_e=(e,a)=>{const o=ye(a.navType);ne(o)},ge=e=>`
    <style>
      .tolstoy-video-page iframe {
        display: block !important;
      }
    </style>
    <tolstoy-video-page
      id="tolstoy-tv-container"
      class="tolstoy-video-page"
      data-publish-id="${e}"
    ></tolstoy-video-page>
  `,Ie=(e={})=>{const{height:a=490}=e;let o=0;const i=setInterval(function(){o++;const n=document.querySelector(".tolstoy-carousel-container"),c=document.querySelector(".tolstoy-carousel");n&&c?(c.style.display="block",ne(a),clearInterval(i)):o>=50&&clearInterval(i)},200)},xe=(e,a)=>{ne(0),Ie(a)},ve=e=>{const a=window?.Tapcart?.variables?.product?.id;return`
    <style>
      * {
        box-sizing: border-box;
        padding: 0;
        margin: 0;
        font-family: Helvetica;
      }
      
      .tolstoy-carousel-wrapper {
        padding-bottom: 25px;
      }
      
      .tolstoy-carousel iframe {
        display: block !important;
      }
    </style>
    <div class="tolstoy-carousel-wrapper">
      <tolstoy-carousel
        class="tolstoy-carousel"
        data-publish-id="${e}"
        style="display: none"
        ${a?`data-product-id="${a}"`:""}
      ></tolstoy-carousel>
    </div>
  `},he=async(e,a)=>{switch(a.blockType){case ee.PDP_CAROUSEL:xe(e,a);break;case ee.VIDEO_PAGE:_e(e,a);break;default:break}},Ne=`
<style>
#tapcart-dashboard-fallback-ui {
  padding: 8px;
  line-height: 20px;
  border: 1px solid black;
}
</style>
<div id="tapcart-dashboard-fallback-ui">
Tolstoy widget will appear here.
<br/>
Click on preview in top right to see widget.
</div>
`,Ae=async()=>{const e=document.querySelectorAll("tolstoy-block");if(e.length!==0){if((0,oe.isTapcartDashboard)()){for(const a of Array.from(e))a.outerHTML=Ne;return}for(const a of Array.from(e)){const{publishId:o,blockType:i,navType:n,height:c}=a.dataset||{},s={blockType:i,navType:n,height:c};let u="";switch(i){case ee.PDP_CAROUSEL:u=ve(o);break;case ee.VIDEO_PAGE:u=ge(o);break;default:break}u&&(a.outerHTML=u,he(a,s))}}};var se=r("aEodP");const Oe=[se.INTERNAL_EVENTS.urlChange];var te=r("aQK74"),se=r("aEodP");const Ce=e=>{switch(e.data.eventName){case se.INTERNAL_EVENTS.urlChange:return(0,te.sendPageVisitEvent)();default:return null}};var Re=r("6QfcD");const Le=["googlebot","google-inspectiontool","google-structured-data-testing-tool","storebot-google","google"],we=["gptbot","chatgpt","openai","gemini","grok","xai","xai-crawler","xai-search","oai","gptbot","perplexitybot","anthropic","perplexity","claude"],Pe=["(+https://whatis.contentkingapp.com)","Shopify-Observe-Synthetic-Checks","https://naver.me/spd","HeadlessChrome","(+http://www.facebook.com/externalhit_uatext.php)","Bytespider","bot"],me=()=>{const e=window.navigator.userAgent.toLowerCase();return Le.some(a=>e.includes(a))},De=()=>Pe.some(e=>window.navigator.userAgent.includes(e)),Me=()=>{const e=window.navigator.userAgent.toLowerCase();return me()?!0:we.some(a=>e.includes(a))},Mt=e=>{const a=e.toLocaleLowerCase();return a.includes("chrome-lighthouse")||a.includes("page speed insights")};var ae=r("519R9"),le=r("ljwIw"),oe=r("lY4N9"),Ue=r("93NPo"),ue=r("4dQPj"),fe=Object.assign(Object.create(null),{url:"file:///packages/widget/src/widgets/widgetloader.js"});const Ve=50,ke="8b32dacc-8f1d-4cce-b641-9f60e88f9414",Ye=()=>{typeof window>"u"||Promise.all([r("3ntgJ"),r("7EyoR"),r("20jZi"),r("9xImz"),r("4xGBK"),r("3CzU6"),r("kT78r"),r("j5yXP"),r("aeVRw"),r("ceBz0"),r("eEPht"),r("9LxpD"),r("8qEs3"),r("eCvYE"),r("46e13"),r("20E5q"),r("bAqc6"),r("9fbdk"),r("c2UxD")])},Be=()=>{if((document.currentScript?.src||fe?.url)?.includes("/we/widget.js")){(0,le.createScript)({src:`https://${de.WIDGET_DOMAIN}/wes/widget.js`,container:document.head,attributes:{type:"module"}});return}(0,le.createScript)({src:`https://${de.WIDGET_DOMAIN}/ws/widget.js`,container:document.head})},He=()=>!!document.body,je=()=>{try{return window.self!==window.top}catch{return!0}},Ke=()=>je()&&window.location.host==="theordinary.com",pe=async()=>{try{if(window.tolstoyWidget||Ke())return;if(De()&&!Me()){console.debug("Bot user");return}if(!He()){setTimeout(pe,Ve);return}if((0,oe.getIsTapcart)()&&await Ae(),(0,oe.isTapcartDashboard)())return;if((0,Ue.getSafeParameter)("td")==="true"&&!document.currentScript?.src?.includes?.("/ws/widget.js")&&!fe?.url?.includes?.("/wes/widget.js")){Be();return}(0,te.registerSiteActivityListenerIfNeeded)(),qe(),ze(),await Promise.all([Ze(),Qe(),Xe()]),et(),(0,te.sendPageVisitEvent)(),await Fe(),await Promise.all([We(),Je(),Ge()]),(0,Ee.tolstoyWidgetReady)()}catch(e){console.log("error",e)}},Fe=async()=>{const{default:e}=await r("intUv");return e.init()};let $e;const Ge=async()=>{const{default:e}=await r("hY2Ky");return $e=new e,$e.init()},We=async e=>{const{default:a}=await r("9xImz");return new a(e).init()},Je=async()=>{const{default:e}=await r("4xGBK");return new e().init()},qe=()=>(ae.default.init(),ae.default),ze=()=>(ue.default.init(),ue.default),Ze=async()=>{const{default:e}=await r("kT78r");e.init();const{subscribe:a,unsubscribe:o}=e;return window.tolstoyWidget={...window.tolstoyWidget,subscribe:a,unsubscribe:o},e},Qe=async()=>{const{default:e}=await r("3CzU6"),{postMessage:a,closePlayer:o,identify:i,changeEmail:n}=e;return window.tolstoyWidget={...window.tolstoyWidget,postMessage:a,closePlayer:o,identify:i,changeEmail:n},e},Xe=async()=>{const[{default:e},{default:a},{default:o},{default:i},{default:n},{default:c},{default:s},{default:u},{default:l},{default:T},{default:_},{default:d}]=await Promise.all([r("j5yXP"),r("aeVRw"),r("ceBz0"),r("eEPht"),r("9LxpD"),r("8qEs3"),r("eCvYE"),r("46e13"),r("20E5q"),r("bAqc6"),r("9fbdk"),r("c2UxD")]);if(e.init(),a.init(),o.init(),i.init(),n.init(),c.init(),s.init(),u.init(),l.init(),T.init(),_.init(),d.init(),(0,Re.getAppKey)()===ke){const{default:I}=await r("aNjZO");I.init()}},et=()=>{ae.default.subscribeMultipleEvents({eventNames:Oe,callback:Ce})};Ye(),pe()})();
