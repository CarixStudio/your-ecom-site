"use strict";(self.webpackChunkshopify_theme=self.webpackChunkshopify_theme||[]).push([[702],{"0e44ce4f366e1cb4b6d4":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{var get_ajax_section=__webpack_require__("43debc60607aaaeb7620"),events=__webpack_require__("104cd0cd3a89b0e4c249"),traversal=__webpack_require__("b56a16cdaeb8dc9b98d0"),init_snippet=__webpack_require__("902890af3e9d44054e88"),freeze_body_scrolling=__webpack_require__("355a436d015b881d6188"),dist=__webpack_require__("f0c1541ca512912fb352"),currency_check=__webpack_require__("04b826e4fa974c7e713a"),main=__webpack_require__("556e9bae4a656349c5e1");(0,init_snippet.initSnippet)("collection-sort",snippet=>{var _findOneElement;const namespace=(0,events.makeEventNamespace)(),mainBus=(0,main.initMainBus)(),templateKey=(_findOneElement=(0,traversal.findOneElement)(document,".js-collection-grid-section"))===null||_findOneElement===void 0?void 0:_findOneElement.getAttribute("data-section-id"),gridContainer=(0,traversal.findOneElement)(document,".js-collection-grid"),loadMoreWrapper=(0,traversal.findOneElement)(document,".js-load-more-wrapper"),selectedSortValue=(0,traversal.findOneElement)(snippet,"[data-current-sort-value]"),sortPopup=(0,traversal.findOneElement)(snippet,".js-collection-sort-popup"),sortTrigger=(0,traversal.findOneElement)(snippet,".js-sort-trigger"),sortOptions=(0,traversal.findElements)(snippet,".js-sort-option"),abortController=new AbortController;let currentSortValue=selectedSortValue?.getAttribute("data-current-sort-value");const cachedSortOption=localStorage.getItem("plp-sort-option");if(!(templateKey&&gridContainer&&currentSortValue&&sortPopup instanceof HTMLElement&&sortTrigger instanceof HTMLButtonElement))return()=>{namespace.destroy()};const checkMobile=()=>{const isMobile=window.innerWidth<821,isActive=sortPopup.classList.contains("mod_collection_sort_oi0uTq_CollectionSort__popup-active"),headerElement=(0,traversal.findOneElement)(document,".Header");isMobile&&isActive?(headerElement?.classList.add("Header__backdroped"),(0,freeze_body_scrolling.freeze)()):(headerElement?.classList.remove("Header__backdroped"),(0,freeze_body_scrolling.thaw)())},toggleSortPopup=()=>{sortPopup.classList.toggle("mod_collection_sort_oi0uTq_CollectionSort__popup-active"),checkMobile()},handleSort=(target,automaticSort=!1)=>{sortTrigger.disabled=!0;try{const selectedValue=target.getAttribute("data-sort-value"),parsedSelectedValue=target.textContent;if(automaticSort||toggleSortPopup(),!selectedValue||!parsedSelectedValue||selectedValue===currentSortValue)return void(sortTrigger.disabled=!1);const sortedUrl=window.location.origin+window.location.pathname+"?sort_by="+target.getAttribute("data-sort-value");(0,get_ajax_section.getAjaxSection)(sortedUrl,{sections:templateKey}).then(res=>{const data=res[templateKey];if(data){var _parsedState_querySelector,_parsedState_querySelector1,_window_okeWidgetApi;const parsedState=new DOMParser().parseFromString(data,"text/html"),productContents=(_parsedState_querySelector=parsedState.querySelector(".js-collection-grid"))===null||_parsedState_querySelector===void 0?void 0:_parsedState_querySelector.innerHTML,loadMoreContents=(_parsedState_querySelector1=parsedState.querySelector(".js-load-more-wrapper"))===null||_parsedState_querySelector1===void 0?void 0:_parsedState_querySelector1.innerHTML;if(!productContents)throw new Error("Sorting URL failed to return product contents");gridContainer.innerHTML=productContents,mainBus.send({name:"request:load-product-cards",details:null,source:{type:"global"}}),(value=>{var _findOneElement2;if(!(selectedSortValue instanceof HTMLSpanElement))return void(sortTrigger.disabled=!1);const parsedValue=((_findOneElement2=(0,traversal.findOneElement)(snippet,`[data-sort-value="${value}"]`))===null||_findOneElement2===void 0?void 0:_findOneElement2.textContent)||"";selectedSortValue?.setAttribute("data-current-sort-value",value),selectedSortValue.textContent=parsedValue||"",currentSortValue=value,(value2=>{sortOptions.forEach(optionButton=>{const isActive=optionButton.getAttribute("data-sort-value")===value2;optionButton.classList.toggle("mod_collection_sort_oi0uTq_CollectionSort__option-active",isActive)})})(value),localStorage.setItem("plp-sort-option",value),sortTrigger.disabled=!1})(selectedValue),loadMoreContents&&loadMoreWrapper&&(loadMoreWrapper.innerHTML=loadMoreContents),(0,currency_check.init)(),!((_window_okeWidgetApi=window.okeWidgetApi)===null||_window_okeWidgetApi===void 0)&&_window_okeWidgetApi.initAllWidgets&&window.okeWidgetApi.initAllWidgets()}})}catch(error){console.error("Error while sorting products:",error),sortTrigger.disabled=!1}},debouncedCheckMobile=(0,dist.debounce)(checkMobile,200),handleKeydown=(evt,callback)=>{evt instanceof KeyboardEvent&&(evt.key!=="Enter"&&evt.key!==" "||(evt.preventDefault(),callback()))};if(window.addEventListener("resize",debouncedCheckMobile,{passive:!0,signal:abortController.signal}),document.addEventListener("click",event=>{const target=event.target;target instanceof Element&&sortPopup.classList.contains("mod_collection_sort_oi0uTq_CollectionSort__popup-active")&&!snippet.contains(target)&&toggleSortPopup()},{passive:!0,signal:abortController.signal}),namespace.addDelegatedEventListener(snippet,"[data-sort-value]","click",target=>handleSort(target)),namespace.addDelegatedEventListener(snippet,".js-sort-trigger, .js-close-popup","click",toggleSortPopup),namespace.addDelegatedEventListener(snippet,".js-sort-trigger, .js-close-popup","keydown",(_,evt)=>handleKeydown(evt,toggleSortPopup)),namespace.addDelegatedEventListener(snippet,"[data-sort-value]","keydown",(target,evt)=>handleKeydown(evt,()=>handleSort(target))),cachedSortOption){const sortOption=(0,traversal.findOneElement)(snippet,`[data-sort-value="${cachedSortOption}"]`);if(!sortOption)return;handleSort(sortOption,!0)}else sortTrigger.disabled=!1;return()=>{abortController.abort(),namespace.destroy()}})}},__webpack_require__=>{__webpack_require__.O(0,[351,945,902,548,275],()=>__webpack_require__(__webpack_require__.s="0e44ce4f366e1cb4b6d4")),__webpack_require__.O()}]);
//# sourceMappingURL=/cdn/shop/t/1074/assets/snippet-collection-sort.js.map?v=110851740637342628331761066874
